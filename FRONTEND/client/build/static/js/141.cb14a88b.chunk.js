"use strict";(self.webpackChunktable_talk_client=self.webpackChunktable_talk_client||[]).push([[141],{708:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var r=a(5043),n=a(3216),s=a(5475),i=a(4117),o=a(2179),l=a(9926),d=a(5016),c=a(3519),p=a(7417),x=a(184),g=a(4935);const u={mealsPage:"MealsPage_mealsPage__pTDB9",topBar:"MealsPage_topBar__3moIl",pageTitle:"MealsPage_pageTitle__NXkaN",searchWrapper:"MealsPage_searchWrapper__H4laZ",searchContainer:"MealsPage_searchContainer__yvmgE",searchIcon:"MealsPage_searchIcon__CODdS",searchInput:"MealsPage_searchInput__tdP0A",content:"MealsPage_content__fbl4o",sectionWrapper:"MealsPage_sectionWrapper__zhdeE",sectionHeader:"MealsPage_sectionHeader__1JfsA",sectionTitle:"MealsPage_sectionTitle__FtV-f",sectionCount:"MealsPage_sectionCount__ZGHXE",emptyFeed:"MealsPage_emptyFeed__h1xXS",heroCard:"MealsPage_heroCard__fGhAh",ctaPrimary:"MealsPage_ctaPrimary__pNEMg",fabButton:"MealsPage_fabButton__4kO1o",fabIcon:"MealsPage_fabIcon__Srk83",recommendedSection:"MealsPage_recommendedSection__en7n9",sectionSubtitle:"MealsPage_sectionSubtitle__lKuWM",pulse:"MealsPage_pulse__dPB0S"};var h=a(7352),m=a(4131),f=a(7930),y=a(579);const b=()=>{const{t:e}=(0,i.Bd)(),{getMealTypeText:t}=(0,g.j)(),a=(0,n.Zp)(),{user:b,isAuthenticated:j,loading:v}=(0,d.A)(),{meals:_,loading:S,error:C,fetchMeals:k}=(0,l.w)(),[w,T]=(0,r.useState)(""),[M,P]=(0,r.useState)(null),[F,I]=(0,r.useState)(!1),[N,z]=(0,r.useState)(""),[A,B]=(0,r.useState)(null);(0,r.useEffect)(()=>{console.log("\ud83d\udd04 MealsPage: Caricamento feed..."),k({status:"upcoming,ongoing"})},[]),(0,r.useEffect)(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{B({latitude:e.coords.latitude,longitude:e.coords.longitude})},e=>{console.log("Posizione non disponibile per AI:",e)})},[]),(0,r.useEffect)(()=>{if(""===w.trim())return P(null),void z("");I(!0),z("");const t=setTimeout(async()=>{try{const e=await o.A.searchMeals(w);P(e.data)}catch(C){z(e("meals.searchError"))}finally{I(!1)}},500);return()=>clearTimeout(t)},[w,e]);const W=(0,r.useMemo)(()=>{if(M)return{};return[...(_||[]).filter(e=>{var t;const a=((null===(t=e.host)||void 0===t?void 0:t._id)||e.host)===((null===b||void 0===b?void 0:b._id)||(null===b||void 0===b?void 0:b.id)),r=new Date(e.date)>new Date;return!a&&r})].sort((e,t)=>new Date(e.date)-new Date(t.date)).reduce((e,t)=>{const a=t.type||"other";return e[a]||(e[a]=[]),e[a].push(t),e},{})},[_,M,b]);if(!v&&!j)return(0,y.jsx)(n.C5,{to:"/login",replace:!0});if(v)return(0,y.jsx)(c.A,{fluid:!0,className:"d-flex justify-content-center align-items-center vh-100",children:(0,y.jsx)(p.A,{animation:"border"})});return(0,y.jsxs)(c.A,{fluid:!0,className:u.mealsPage,children:[(0,y.jsxs)("div",{className:u.topBar,children:[(0,y.jsx)(h.A,{className:u.backButton}),(0,y.jsx)("h1",{className:u.pageTitle,children:"Esplora"}),(0,y.jsx)("div",{style:{width:40}})]}),(0,y.jsx)("div",{className:u.searchWrapper,children:(0,y.jsxs)("div",{className:u.searchContainer,children:[(0,y.jsx)(x.KSO,{className:u.searchIcon}),(0,y.jsx)("input",{type:"text",placeholder:e("meals.searchPlaceholder"),className:u.searchInput,value:w,onChange:e=>T(e.target.value)})]})}),(0,y.jsx)("div",{className:u.content,children:(()=>{if(F)return(0,y.jsxs)("div",{className:"text-center py-4",children:[(0,y.jsx)(p.A,{animation:"border",size:"sm"})," ",e("meals.loading")]});if(N)return(0,y.jsx)("div",{className:"text-center py-4 text-danger",children:N});if(M)return M.length>0?(0,y.jsxs)("div",{className:"mt-3",children:[(0,y.jsx)("h5",{children:"Risultati"}),(0,y.jsx)(m.A,{meals:M})]}):(0,y.jsx)("div",{className:"text-center py-5 text-muted",children:"Nessun risultato."});if(S&&(!_||0===_.length))return(0,y.jsx)("div",{className:"text-center py-5",children:(0,y.jsx)(p.A,{animation:"border"})});if(C)return(0,y.jsx)("div",{className:"text-center py-5 text-danger",children:C});if(0===Object.keys(W).length)return(0,y.jsx)("div",{className:u.emptyFeed,children:(0,y.jsxs)("div",{className:u.heroCard,children:[(0,y.jsx)(x.xBk,{size:40,className:"mb-3 text-primary"}),(0,y.jsx)("h2",{children:e("meals.emptyFeed.title")}),(0,y.jsx)("p",{children:e("meals.emptyFeed.description")}),(0,y.jsx)(s.N_,{to:"/meals/create",className:u.ctaPrimary,children:e("meals.createButton")})]})});const r=["breakfast","lunch","dinner","snack","drink","other"],n=Object.keys(W).sort((e,t)=>{const a=r.indexOf(e),n=r.indexOf(t);return(-1===a?999:a)-(-1===n?999:n)});return(0,y.jsxs)(y.Fragment,{children:[!M&&A&&(0,y.jsx)(f.A,{userLocation:A,onMealSelect:e=>a("/meals/".concat(e._id))}),n.map(e=>(0,y.jsxs)("div",{className:u.sectionWrapper,children:[(0,y.jsxs)("div",{className:u.sectionHeader,children:[(0,y.jsx)("h3",{className:u.sectionTitle,children:t(e)}),(0,y.jsx)("span",{className:u.sectionCount,children:W[e].length})]}),(0,y.jsx)(m.A,{meals:W[e]})]},e))]})})()}),(0,y.jsx)(s.N_,{to:"/meals/create",className:u.fabButton,children:(0,y.jsx)("span",{className:u.fabIcon,children:"+"})})]})}},7930:(e,t,a)=>{a.d(t,{A:()=>l});var r=a(5043),n=a(5016),s=a(7102),i=a(5950),o=a(579);const l=e=>{let{userLocation:t,onMealSelect:a,showTitle:l=!0}=e;const{user:d}=(0,n.A)(),[c,p]=(0,r.useState)([]),[x,g]=(0,r.useState)(!1),[u,h]=(0,r.useState)("");(0,r.useEffect)(()=>{t&&d&&m()},[t,d]);const m=async()=>{try{g(!0),h("");const{data:e}=await s.default.get("/ai/recommendations",{params:{latitude:t.latitude,longitude:t.longitude,limit:4},suppressErrorAlert:!0});p((null===e||void 0===e?void 0:e.recommendations)||(null===e||void 0===e?void 0:e.data)||[])}catch(u){console.error("\u274c [AIRecommendations] Error:",u),h("")}finally{g(!1)}};return x?(0,o.jsxs)("div",{style:{padding:"20px 15px"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"40px 20px",backgroundColor:"#f8f9fa",borderRadius:"16px",border:"1px solid #e9ecef"},children:[(0,o.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid #FF6B35",borderTopColor:"transparent",borderRadius:"50%",animation:"spin 1s linear infinite",marginRight:"12px"}}),(0,o.jsx)("span",{style:{color:"#666",fontSize:"16px"},children:"L'AI sta cercando i migliori TableTalk\xae per te..."})]}),(0,o.jsx)("style",{children:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n          @keyframes shimmer {\n            0% { transform: translate(-50%, -50%) rotate(0deg); }\n            100% { transform: translate(-50%, -50%) rotate(360deg); }\n          }\n        "})]}):u||0===c.length?null:(0,o.jsxs)("div",{style:{margin:"25px 0"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"32px",padding:"0 15px"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"14px"},children:[(0,o.jsxs)("div",{style:{width:"48px",height:"48px",borderRadius:"14px",background:"linear-gradient(135deg, #FF6B35 0%, #F7931E 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",boxShadow:"0 4px 16px rgba(255, 107, 53, 0.25)",position:"relative",overflow:"hidden"},children:[(0,o.jsx)("span",{style:{position:"relative",zIndex:2,filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))"},children:"\ud83e\udd16"}),(0,o.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",width:"200%",height:"200%",background:"radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%)",animation:"shimmer 3s infinite"}})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{style:{margin:0,fontSize:"24px",fontWeight:"700",color:"#1a1a1a",letterSpacing:"-0.5px",lineHeight:"1.2"},children:"Raccomandazioni AI"}),(0,o.jsx)("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"#666",fontWeight:"400",lineHeight:"1.4"},children:"TableTalk\xae selezionati personalmente per te"})]})]}),(0,o.jsxs)("button",{onClick:m,disabled:x,style:{padding:"10px 18px",backgroundColor:"#fff",border:"1.5px solid #e8e8e8",borderRadius:"12px",fontSize:"13px",cursor:x?"not-allowed":"pointer",color:"#666",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:"500",display:"flex",alignItems:"center",gap:"6px",opacity:x?.6:1},onMouseEnter:e=>{x||(e.currentTarget.style.backgroundColor="#f8f9fa",e.currentTarget.style.borderColor="#FF6B35",e.currentTarget.style.color="#FF6B35",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 4px 12px rgba(255, 107, 53, 0.15)")},onMouseLeave:e=>{x||(e.currentTarget.style.backgroundColor="#fff",e.currentTarget.style.borderColor="#e8e8e8",e.currentTarget.style.color="#666",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="none")},children:[(0,o.jsx)("span",{children:"\ud83d\udd04"}),(0,o.jsx)("span",{children:"Aggiorna"})]})]}),(0,o.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"24px",padding:"0 15px"},children:c.slice(0,4).map((e,t)=>{var r,n;return(0,o.jsxs)("div",{onClick:()=>(async e=>{try{await s.default.post("/ai/interaction",{mealId:e._id,interactionType:"viewed",mealData:{cuisineType:e.cuisineType,price:e.estimatedCost}},{suppressErrorAlert:!0}),a&&a(e)}catch(u){console.error("\u274c Failed to track interaction:",u),a&&a(e)}})(e),style:{backgroundColor:"#fff",borderRadius:"20px",boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid #f0f0f0",overflow:"hidden",cursor:"pointer",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",willChange:"transform"},onMouseEnter:e=>{e.currentTarget.style.transform="translateY(-8px) scale(1.02)",e.currentTarget.style.boxShadow="0 12px 40px rgba(0,0,0,0.15)",e.currentTarget.style.borderColor="#FF6B35"},onMouseLeave:e=>{e.currentTarget.style.transform="translateY(0) scale(1)",e.currentTarget.style.boxShadow="0 4px 20px rgba(0,0,0,0.08)",e.currentTarget.style.borderColor="#f0f0f0"},children:[0===t&&(0,o.jsx)("div",{style:{position:"absolute",top:"12px",left:"12px",zIndex:3,display:"flex",alignItems:"center",gap:"4px",backgroundColor:"#FF6B35",color:"white",padding:"4px 8px",borderRadius:"6px",fontSize:"11px",fontWeight:"600",boxShadow:"0 2px 8px rgba(255, 107, 53, 0.3)"},children:"\u2b50 TOP MATCH"}),(0,o.jsxs)("div",{style:{position:"absolute",top:"14px",right:"14px",zIndex:3,background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.9) 100%)",backdropFilter:"blur(10px)",color:"#FF6B35",padding:"6px 12px",borderRadius:"20px",fontSize:"12px",fontWeight:"700",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",display:"flex",alignItems:"center",gap:"4px",border:"1px solid rgba(255,255,255,0.3)"},children:[(0,o.jsx)("span",{style:{fontSize:"14px"},children:"\u2728"}),(0,o.jsxs)("span",{children:[Math.round(e.aiScore||e.aiCompatibility||85),"%"]})]}),(0,o.jsxs)("div",{style:{height:"180px",background:e.imageUrl||e.image?"linear-gradient(rgba(0,0,0,0.15), rgba(0,0,0,0.4)), url(".concat((0,i.xW)(e.imageUrl||e.image),")"):"linear-gradient(135deg, #FF6B35 0%, #F7931E 50%, #FF8A65 100%)",backgroundSize:"cover",backgroundPosition:"center",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.4s cubic-bezier(0.4, 0, 0.2, 1)",overflow:"hidden"},children:[(0,o.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"60%",background:"linear-gradient(to top, rgba(0,0,0,0.5), transparent)",pointerEvents:"none"}}),!e.imageUrl&&!e.image&&(0,o.jsx)("div",{style:{fontSize:"56px",opacity:.95,filter:"drop-shadow(0 4px 8px rgba(0,0,0,0.2))"},children:"\ud83c\udf7d\ufe0f"})]}),(0,o.jsxs)("div",{style:{padding:"16px"},children:[(0,o.jsx)("h4",{style:{margin:"0 0 6px 0",fontSize:"16px",fontWeight:"600",color:"#1a1a1a",lineHeight:"1.3",height:"40px",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:e.title}),(0,o.jsxs)("p",{style:{margin:"0 0 12px 0",fontSize:"12px",color:"#FF6B35",fontWeight:"500",fontStyle:"italic"},children:["\ud83e\udd16 ",e.aiReason||"Perfetto per i tuoi gusti"]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"8px"},children:[(0,o.jsxs)("span",{style:{fontSize:"13px",color:"#666",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1,marginRight:"8px"},children:["\ud83d\udccd ",(null===(r=e.location)||void 0===r?void 0:r.name)||"Ristorante"]}),e.distanceKm&&(0,o.jsxs)("span",{style:{fontSize:"11px",color:"#999",backgroundColor:"#f8f9fa",padding:"2px 6px",borderRadius:"4px",flexShrink:0},children:[e.distanceKm.toFixed(1),"km"]})]}),(0,o.jsxs)("div",{style:{fontSize:"13px",color:"#666",marginBottom:"10px"},children:["\u23f0 ",new Date(e.scheduledAt).toLocaleDateString("it-IT",{month:"short",day:"numeric"})," \u2022 ",new Date(e.scheduledAt).toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[(0,o.jsxs)("span",{style:{fontSize:"12px",color:"#666",display:"flex",alignItems:"center",gap:"3px"},children:["\ud83d\udc65 ",(null===(n=e.participants)||void 0===n?void 0:n.length)||0,"/",e.maxParticipants||8]}),e.estimatedCost&&(0,o.jsxs)("span",{style:{fontSize:"13px",fontWeight:"600",color:"#1a1a1a"},children:["\u20ac",e.estimatedCost]})]}),(0,o.jsx)("div",{style:{padding:"6px 12px",backgroundColor:"#FF6B35",color:"white",borderRadius:"20px",fontSize:"12px",fontWeight:"600"},children:"Partecipa \u2192"})]})]})]},e._id)})}),c.length>0&&(0,o.jsx)("div",{style:{textAlign:"center",marginTop:"20px",paddingTop:"16px"},children:(0,o.jsx)("button",{onClick:m,style:{padding:"12px 24px",backgroundColor:"transparent",color:"#666",border:"1px solid #e0e0e0",borderRadius:"25px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.backgroundColor="#f8f9fa",e.target.style.borderColor="#ccc"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent",e.target.style.borderColor="#e0e0e0"},children:"\ud83d\udd04 Altri suggerimenti AI"})})]})}}}]);
//# sourceMappingURL=141.cb14a88b.chunk.js.map