"use strict";(self.webpackChunktable_talk_client=self.webpackChunktable_talk_client||[]).push([[214],{2346:(e,s,a)=>{a.d(s,{A:()=>p});var n=a(3818),o=a(5043);var l=a(3539),t=a(9048),i=a(5901),r=a(8466),c=a(5425),d=a(2644),u=a(579);const g=["as","onSelect","activeKey","role","onKeyDown"];const m=()=>{},h=(0,c.sE)("event-key"),f=o.forwardRef((e,s)=>{let{as:a="div",onSelect:d,activeKey:f,role:p,onKeyDown:x}=e,v=function(e,s){if(null==e)return{};var a={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(s.indexOf(n)>=0)continue;a[n]=e[n]}return a}(e,g);const _=function(){const[,e]=(0,o.useReducer)(e=>e+1,0);return e}(),j=(0,o.useRef)(!1),P=(0,o.useContext)(i.A),w=(0,o.useContext)(r.A);let A,N;w&&(p=p||"tablist",f=w.activeKey,A=w.getControlledId,N=w.getControllerId);const b=(0,o.useRef)(null),y=e=>{const s=b.current;if(!s)return null;const a=(0,n.A)(s,"[".concat(h,"]:not([aria-disabled=true])")),o=s.querySelector("[aria-selected=true]");if(!o||o!==document.activeElement)return null;const l=a.indexOf(o);if(-1===l)return null;let t=l+e;return t>=a.length&&(t=0),t<0&&(t=a.length-1),a[t]},C=(e,s)=>{null!=e&&(null==d||d(e,s),null==P||P(e,s))};(0,o.useEffect)(()=>{if(b.current&&j.current){const e=b.current.querySelector("[".concat(h,"][aria-selected=true]"));null==e||e.focus()}j.current=!1});const k=(0,l.A)(s,b);return(0,u.jsx)(i.A.Provider,{value:C,children:(0,u.jsx)(t.A.Provider,{value:{role:p,activeKey:(0,i.u)(f),getControlledId:A||m,getControllerId:N||m},children:(0,u.jsx)(a,Object.assign({},v,{onKeyDown:e=>{if(null==x||x(e),!w)return;let s;switch(e.key){case"ArrowLeft":case"ArrowUp":s=y(-1);break;case"ArrowRight":case"ArrowDown":s=y(1);break;default:return}s&&(e.preventDefault(),C(s.dataset[(0,c.y)("EventKey")]||null,e),j.current=!0,_())},ref:k,role:p}))})})});f.displayName="Nav";const p=Object.assign(f,{Item:d.A})},2644:(e,s,a)=>{a.d(s,{A:()=>h,M:()=>g});var n=a(5043),o=a(8894),l=a(9048),t=a(5901),i=a(4140),r=a(5425),c=a(8466),d=a(579);const u=["as","active","eventKey"];function g(e){let{key:s,onClick:a,active:i,id:d,role:u,disabled:g}=e;const m=(0,n.useContext)(t.A),h=(0,n.useContext)(l.A),f=(0,n.useContext)(c.A);let p=i;const x={role:u};if(h){u||"tablist"!==h.role||(x.role="tab");const e=h.getControllerId(null!=s?s:null),a=h.getControlledId(null!=s?s:null);x[(0,r.sE)("event-key")]=s,x.id=e||d,p=null==i&&null!=s?h.activeKey===s:i,!p&&(null!=f&&f.unmountOnExit||null!=f&&f.mountOnEnter)||(x["aria-controls"]=a)}return"tab"===x.role&&(x["aria-selected"]=p,p||(x.tabIndex=-1),g&&(x.tabIndex=-1,x["aria-disabled"]=!0)),x.onClick=(0,o.A)(e=>{g||(null==a||a(e),null!=s&&m&&!e.isPropagationStopped()&&m(s,e))}),[x,{isActive:p}]}const m=n.forwardRef((e,s)=>{let{as:a=i.Ay,active:n,eventKey:o}=e,l=function(e,s){if(null==e)return{};var a={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(s.indexOf(n)>=0)continue;a[n]=e[n]}return a}(e,u);const[c,m]=g(Object.assign({key:(0,t.u)(o,l.href),active:n},l));return c[(0,r.sE)("active")]=m.isActive,(0,d.jsx)(a,Object.assign({},l,c,{ref:s}))});m.displayName="NavItem";const h=m},3519:(e,s,a)=>{a.d(s,{A:()=>g});var n=a(2555),o=a(45),l=a(8139),t=a.n(l),i=a(5043),r=a(7852),c=a(579);const d=["bsPrefix","fluid","as","className"],u=i.forwardRef((e,s)=>{let{bsPrefix:a,fluid:l=!1,as:i="div",className:u}=e,g=(0,o.A)(e,d);const m=(0,r.oU)(a,"container"),h="string"===typeof l?"-".concat(l):"-fluid";return(0,c.jsx)(i,(0,n.A)((0,n.A)({ref:s},g),{},{className:t()(u,l?"".concat(m).concat(h):m)}))});u.displayName="Container";const g=u},5901:(e,s,a)=>{a.d(s,{A:()=>l,u:()=>o});var n=a(5043);const o=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e?String(e):s||null},l=n.createContext(null)},6244:(e,s,a)=>{a.r(s),a.d(s,{default:()=>$e});var n=a(5043),o=a(7417),l=a(3519),t=a(1719),i=a(4282),r=a(3401),c=a(4117),d=a(184),u=a(5016),g=a(7469),m=a(8614),h=a(5475);const f="ProfileHeader_profileHeader__sz2AA",p="ProfileHeader_profileImageContainer__EX57U",x="ProfileHeader_profileImage__KTLE+",v="ProfileHeader_cameraButton__wumnZ",_="ProfileHeader_disabled__wJWmF",j="ProfileHeader_profileInfo__J1rQE",P="ProfileHeader_nickname__AasSW",w="ProfileHeader_userEmail__VGlFK",A="ProfileHeader_myMealsButton__9J2tW",N="ProfileHeader_bio__O+Ysz";var b=a(579);const y=e=>{let{profile:s,onUpdateImage:a,isPublicView:o=!1}=e;const{t:l}=(0,c.Bd)(),[t,i]=(0,n.useState)(!1);if(!s)return null;const r=g.A.getFullImageUrl(s.profileImage);return console.log("\ud83d\uddbc\ufe0f [ProfileHeader] Profile image URL:",r),console.log("\ud83d\uddbc\ufe0f [ProfileHeader] Profile image field:",s.profileImage),(0,b.jsxs)("div",{className:f,children:[(0,b.jsxs)("div",{className:p,children:[(0,b.jsx)("img",{src:r,alt:l("profile.header.avatarAlt"),className:x,onError:e=>{console.log("\u274c Errore caricamento immagine profilo in ProfileHeader:",e);try{const s=g.A.getFullImageUrl("uploads/profile-images/default-avatar.jpg");e.target.src=s}catch(s){}}},s.profileImage),!o&&(0,b.jsxs)("label",{htmlFor:"image-upload",className:"".concat(v," ").concat(t?_:""),children:[(0,b.jsx)(d.p5B,{}),(0,b.jsx)("input",{id:"image-upload",type:"file",accept:"image/*",onChange:async e=>{const s=e.target.files[0];if(s){i(!0);try{const e=new FormData;e.append("avatar",s),a&&(await a(e),console.log("\u2705 [ProfileHeader] Immagine caricata, forzando refresh..."))}catch(n){console.error("Errore durante l'upload:",n)}finally{i(!1)}}},style:{display:"none"},disabled:t})]})]}),(0,b.jsxs)("div",{className:j,children:[(0,b.jsx)("h1",{className:P,children:s.nickname||l("profile.header.noNickname")}),o?(0,b.jsx)("p",{className:N,children:s.bio||l("profile.header.noBio")}):(0,b.jsx)("p",{className:w,children:s.email}),!o&&(0,b.jsxs)(h.N_,{to:"/my-meals",className:A,children:[(0,b.jsx)(d.xBk,{}),(0,b.jsx)("span",{children:l("profile.header.myMealsButton")})]})]})]})};var C=a(4122),k=a(1271),M=a(4442);const S="LanguagesSection_container__Razy3",I="LanguagesSection_sectionTitle__5VbSC",L="LanguagesSection_languagesList__+WiZw",D="LanguagesSection_languageTag__8Kgsr",U="LanguagesSection_languageCode__-ngTg",B="LanguagesSection_languageName__ySoYi",E="LanguagesSection_noLanguages__As-iv",H="LanguagesSection_selectedLanguages__3CwIg",R="LanguagesSection_removeButton__woKH8",O="LanguagesSection_addLanguageSection__In1O0",T="LanguagesSection_addButton__UwWMt",z="LanguagesSection_dropdown__WHbqu",q="LanguagesSection_languageOption__VOtKS",K="LanguagesSection_addIcon__tIkcL",F="LanguagesSection_helpText__WO1gw",G=e=>{let{profileData:s,onUpdate:a,isEditing:o=!1}=e;const{t:l}=(0,c.Bd)(),[t,i]=(0,n.useState)([]),[r,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{null!==s&&void 0!==s&&s.languages&&i(s.languages)},[null===s||void 0===s?void 0:s.languages]);const g=e=>{const s=M.ln.find(s=>s.code===e);return s?s.name:e},m=()=>M.ln.filter(e=>!t.includes(e.code));return o?(0,b.jsxs)("div",{className:S,children:[(0,b.jsxs)("h3",{className:I,children:[(0,b.jsx)(d.f35,{})," ",l("publicProfile.languagesSection.title")]}),(0,b.jsx)("div",{className:H,children:t.map(e=>(0,b.jsxs)("div",{className:D,children:[(0,b.jsx)("span",{className:U,children:e.toUpperCase()}),(0,b.jsx)("span",{className:B,children:g(e)}),(0,b.jsx)("button",{className:R,onClick:()=>(e=>{const s=t.filter(s=>s!==e);i(s),a({languages:s})})(e),title:"".concat(l("publicProfile.languagesSection.removeLanguage")," ").concat(g(e)),children:(0,b.jsx)(d.QCr,{})})]},e))}),(0,b.jsxs)("div",{className:O,children:[(0,b.jsx)("button",{className:T,onClick:()=>{o&&u(!r)},disabled:0===m().length,children:l("publicProfile.languagesSection.addLanguage")}),r&&(0,b.jsx)("div",{className:z,children:m().map(e=>(0,b.jsxs)("button",{className:q,onClick:()=>(e=>{const s=t.includes(e)?t.filter(s=>s!==e):[...t,e];i(s),a({languages:s})})(e.code),children:[(0,b.jsx)("span",{className:U,children:e.code.toUpperCase()}),(0,b.jsx)("span",{className:B,children:e.name}),(0,b.jsx)(d.CMH,{className:K})]},e.code))})]}),0===t.length&&(0,b.jsx)("p",{className:F,children:l("publicProfile.languagesSection.helpText")})]}):(0,b.jsxs)("div",{className:S,children:[(0,b.jsxs)("h3",{className:I,children:[(0,b.jsx)(d.f35,{})," ",l("publicProfile.languagesSection.title")]}),t.length>0?(0,b.jsx)("div",{className:L,children:t.map(e=>(0,b.jsxs)("div",{className:D,children:[(0,b.jsx)("span",{className:U,children:e.toUpperCase()}),(0,b.jsx)("span",{className:B,children:g(e)})]},e))}):(0,b.jsx)("p",{className:E,children:l("publicProfile.languagesSection.noLanguagesConfigured")})]})};var W=a(2555),Y=a(5849),J=a(45),Z=a(8139),Q=a.n(Z),V=(a(6440),a(1969)),X=a(2346),$=a(7852),ee=a(6618),se=a(2644),ae=a(5901);const ne=["bsPrefix","active","disabled","eventKey","className","variant","action","as"],oe=n.forwardRef((e,s)=>{let{bsPrefix:a,active:n,disabled:o,eventKey:l,className:t,variant:i,action:r,as:c}=e,d=(0,J.A)(e,ne);a=(0,$.oU)(a,"list-group-item");const[u,g]=(0,se.M)((0,W.A)({key:(0,ae.u)(l,d.href),active:n},d)),m=(0,ee.A)(e=>{if(o)return e.preventDefault(),void e.stopPropagation();u.onClick(e)});o&&void 0===d.tabIndex&&(d.tabIndex=-1,d["aria-disabled"]=!0);const h=c||(r?d.href?"a":"button":"div");return(0,b.jsx)(h,(0,W.A)((0,W.A)((0,W.A)({ref:s},d),u),{},{onClick:m,className:Q()(t,a,g.isActive&&"active",o&&"disabled",i&&"".concat(a,"-").concat(i),r&&"".concat(a,"-action"))}))});oe.displayName="ListGroupItem";const le=oe,te=["className","bsPrefix","variant","horizontal","numbered","as"],ie=n.forwardRef((e,s)=>{const a=(0,V.Zw)(e,{activeKey:"onSelect"}),{className:n,bsPrefix:o,variant:l,horizontal:t,numbered:i,as:r="div"}=a,c=(0,J.A)(a,te),d=(0,$.oU)(o,"list-group");let u;return t&&(u=!0===t?"horizontal":"horizontal-".concat(t)),(0,b.jsx)(X.A,(0,W.A)((0,W.A)({ref:s},c),{},{as:r,className:Q()(n,d,l&&"".concat(d,"-").concat(l),u&&"".concat(d,"-").concat(u),i&&"".concat(d,"-numbered"))}))});ie.displayName="ListGroup";const re=Object.assign(ie,{Item:le});var ce=a(8298);const de="DeleteAccountModal_header__YAFOD",ue="DeleteAccountModal_title__BJL1+",ge="DeleteAccountModal_warningIcon__H9uka",me="DeleteAccountModal_body__sStV6",he="DeleteAccountModal_warningAlert__c+x9b",fe="DeleteAccountModal_userInfo__+vP2Z",pe="DeleteAccountModal_userAvatar__l5EDS",xe="DeleteAccountModal_sectionTitle__iHJwe",ve="DeleteAccountModal_consequencesList__2Gm3P",_e="DeleteAccountModal_consequenceItem__G74sQ",je="DeleteAccountModal_consequenceIcon__6FzLt",Pe="DeleteAccountModal_checkboxes__flJH+",we="DeleteAccountModal_checkbox__nEfxC",Ae="DeleteAccountModal_actions__j9swH",Ne="DeleteAccountModal_successStep__CN5qi",be="DeleteAccountModal_successIcon__L3y18",ye=e=>{let{show:s,onHide:a,onDeleteAccount:o,user:l}=e;const{t:r}=(0,c.Bd)(),[u,g]=(0,n.useState)(1),[m,h]=(0,n.useState)({password:"",confirmCheckbox:!1,understandCheckbox:!1}),[f,p]=(0,n.useState)(!1),[x,v]=(0,n.useState)(""),_=()=>{f||(a(),g(1),h({password:"",confirmCheckbox:!1,understandCheckbox:!1}),v(""))},j=(m.confirmCheckbox&&m.understandCheckbox&&m.password,[r("deleteAccountModal.consequences.profile"),r("deleteAccountModal.consequences.meals"),r("deleteAccountModal.consequences.chat"),r("deleteAccountModal.consequences.invitations"),r("deleteAccountModal.consequences.access"),r("deleteAccountModal.consequences.irreversible")]);return(0,b.jsxs)(Y.A,{show:s,onHide:_,centered:!0,size:"lg",children:[(0,b.jsx)(Y.A.Header,{closeButton:!0,className:de,children:(0,b.jsxs)(Y.A.Title,{className:ue,children:[(0,b.jsx)(d.BS8,{className:ge}),r("deleteAccountModal.title")]})}),(0,b.jsxs)(Y.A.Body,{className:me,children:[1===u&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(t.A,{variant:"danger",className:he,children:[(0,b.jsx)(t.A.Heading,{children:r("deleteAccountModal.warningTitle")}),(0,b.jsx)("p",{children:r("deleteAccountModal.warningMessage")})]}),(0,b.jsxs)("div",{className:fe,children:[(0,b.jsx)("img",{src:null!==l&&void 0!==l&&l.profileImage?"/uploads/profile-images/".concat(l.profileImage):"/default-avatar.jpg",alt:null===l||void 0===l?void 0:l.nickname,className:pe}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h6",{children:null===l||void 0===l?void 0:l.nickname}),(0,b.jsx)("small",{className:"text-muted",children:r("deleteAccountModal.accountToDelete")})]})]}),(0,b.jsx)("h6",{className:xe,children:r("deleteAccountModal.whatWillHappen")}),(0,b.jsx)(re,{className:ve,children:j.map((e,s)=>(0,b.jsxs)(re.Item,{className:_e,children:[(0,b.jsx)(d.QCr,{className:je}),e]},s))}),(0,b.jsxs)("div",{className:Pe,children:[(0,b.jsx)(ce.A.Check,{type:"checkbox",id:"confirmCheckbox",label:r("deleteAccountModal.confirmDelete"),checked:m.confirmCheckbox,onChange:e=>h((0,W.A)((0,W.A)({},m),{},{confirmCheckbox:e.target.checked})),className:we}),(0,b.jsx)(ce.A.Check,{type:"checkbox",id:"understandCheckbox",label:r("deleteAccountModal.understandIrreversible"),checked:m.understandCheckbox,onChange:e=>h((0,W.A)((0,W.A)({},m),{},{understandCheckbox:e.target.checked})),className:we})]}),(0,b.jsxs)("div",{className:Ae,children:[(0,b.jsx)(i.A,{variant:"secondary",onClick:_,disabled:f,children:r("deleteAccountModal.cancel")}),(0,b.jsxs)(i.A,{variant:"danger",onClick:()=>g(2),disabled:!m.confirmCheckbox||!m.understandCheckbox||f,children:[(0,b.jsx)(d.qbC,{})," ",r("deleteAccountModal.proceed")]})]})]}),2===u&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.A,{variant:"warning",children:(0,b.jsx)("strong",{children:r("deleteAccountModal.lastStep")})}),x&&(0,b.jsx)(t.A,{variant:"danger",children:x}),(0,b.jsxs)(ce.A,{onSubmit:async e=>{if(e.preventDefault(),m.password)if(m.confirmCheckbox&&m.understandCheckbox){p(!0),v("");try{await o(m.password),g(3),setTimeout(()=>{_()},3e3)}catch(n){var s,a;v((null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||r("deleteAccountModal.deleteError"))}finally{p(!1)}}else v(r("deleteAccountModal.confirmAllOptions"));else v(r("deleteAccountModal.passwordRequired"))},children:[(0,b.jsxs)(ce.A.Group,{className:"mb-3",children:[(0,b.jsx)(ce.A.Label,{children:r("deleteAccountModal.password")}),(0,b.jsx)(ce.A.Control,{type:"password",value:m.password,onChange:e=>h((0,W.A)((0,W.A)({},m),{},{password:e.target.value})),placeholder:r("deleteAccountModal.passwordPlaceholder"),required:!0})]}),(0,b.jsxs)("div",{className:Ae,children:[(0,b.jsx)(i.A,{variant:"secondary",onClick:()=>g(1),disabled:f,children:r("deleteAccountModal.back")}),(0,b.jsx)(i.A,{variant:"danger",type:"submit",disabled:!m.password||f,children:r(f?"deleteAccountModal.deleting":"deleteAccountModal.deleteDefinitely")})]})]})]}),3===u&&(0,b.jsxs)("div",{className:Ne,children:[(0,b.jsx)("div",{className:be,children:(0,b.jsx)(d.CMH,{})}),(0,b.jsx)("h5",{children:r("deleteAccountModal.accountDeleted")}),(0,b.jsx)("p",{children:r("deleteAccountModal.deletedSuccess")}),(0,b.jsx)("small",{className:"text-muted",children:r("deleteAccountModal.redirecting")})]})]})]})},Ce="ChangePasswordModal_header__0xOeY",ke="ChangePasswordModal_title__Ao3uM",Me="ChangePasswordModal_keyIcon__YTslb",Se="ChangePasswordModal_body__YS8Wk",Ie="ChangePasswordModal_description__XqCZE",Le="ChangePasswordModal_errorAlert__MnZNa",De="ChangePasswordModal_passwordInputGroup__LT8tr",Ue="ChangePasswordModal_eyeButton__YQS07",Be="ChangePasswordModal_actions__yRlw+",Ee=e=>{let{show:s,onHide:a,onChangePassword:o}=e;const{t:l}=(0,c.Bd)(),[r,u]=(0,n.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[g,m]=(0,n.useState)({current:!1,new:!1,confirm:!1}),[h,f]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[v,_]=(0,n.useState)({}),j=()=>{h||(a(),u({currentPassword:"",newPassword:"",confirmPassword:""}),m({current:!1,new:!1,confirm:!1}),x(""),_({}))},P=e=>{const{name:s,value:a}=e.target;u(e=>(0,W.A)((0,W.A)({},e),{},{[s]:a})),v[s]&&_(e=>(0,W.A)((0,W.A)({},e),{},{[s]:""}))},w=e=>{m(s=>(0,W.A)((0,W.A)({},s),{},{[e]:!s[e]}))},A=Object.values(v).some(e=>e)||p;return(0,b.jsxs)(Y.A,{show:s,onHide:j,centered:!0,children:[(0,b.jsx)(Y.A.Header,{closeButton:!0,className:Ce,children:(0,b.jsxs)(Y.A.Title,{className:ke,children:[(0,b.jsx)(d.pXu,{className:Me}),l("changePasswordModal.title")]})}),(0,b.jsxs)(Y.A.Body,{className:Se,children:[(0,b.jsx)("p",{className:Ie,children:l("changePasswordModal.description")}),p&&(0,b.jsx)(t.A,{variant:"danger",className:Le,children:p}),(0,b.jsxs)(ce.A,{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return r.currentPassword||(e.currentPassword=l("changePasswordModal.currentPasswordRequired")),r.newPassword?r.newPassword.length<8?e.newPassword=l("changePasswordModal.passwordMinLength"):/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])/.test(r.newPassword)||(e.newPassword=l("changePasswordModal.passwordRequirements")):e.newPassword=l("changePasswordModal.newPasswordRequired"),r.confirmPassword?r.newPassword!==r.confirmPassword&&(e.confirmPassword=l("changePasswordModal.passwordsDoNotMatch")):e.confirmPassword=l("changePasswordModal.confirmPasswordRequired"),_(e),0===Object.keys(e).length})()){f(!0),x("");try{await o(r.currentPassword,r.newPassword),j()}catch(n){var s,a;x((null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||l("changePasswordModal.changeError"))}finally{f(!1)}}},children:[(0,b.jsxs)(ce.A.Group,{className:"mb-3",children:[(0,b.jsxs)(ce.A.Label,{children:[l("changePasswordModal.currentPassword")," *"]}),(0,b.jsxs)("div",{className:De,children:[(0,b.jsx)(ce.A.Control,{type:g.current?"text":"password",name:"currentPassword",value:r.currentPassword,onChange:P,placeholder:l("changePasswordModal.currentPasswordPlaceholder"),isInvalid:!!v.currentPassword,disabled:h}),(0,b.jsx)(i.A,{type:"button",variant:"outline-secondary",className:Ue,onClick:()=>w("current"),disabled:h,children:g.current?(0,b.jsx)(d.mx3,{}):(0,b.jsx)(d.Ny1,{})})]}),v.currentPassword&&(0,b.jsx)(ce.A.Control.Feedback,{type:"invalid",children:v.currentPassword})]}),(0,b.jsxs)(ce.A.Group,{className:"mb-3",children:[(0,b.jsxs)(ce.A.Label,{children:[l("changePasswordModal.newPassword")," *"]}),(0,b.jsxs)("div",{className:De,children:[(0,b.jsx)(ce.A.Control,{type:g.new?"text":"password",name:"newPassword",value:r.newPassword,onChange:P,placeholder:l("changePasswordModal.newPasswordPlaceholder"),isInvalid:!!v.newPassword,disabled:h}),(0,b.jsx)(i.A,{type:"button",variant:"outline-secondary",className:Ue,onClick:()=>w("new"),disabled:h,children:g.new?(0,b.jsx)(d.mx3,{}):(0,b.jsx)(d.Ny1,{})})]}),v.newPassword&&(0,b.jsx)(ce.A.Control.Feedback,{type:"invalid",children:v.newPassword}),(0,b.jsx)(ce.A.Text,{className:"text-muted",children:l("changePasswordModal.passwordRequirements")})]}),(0,b.jsxs)(ce.A.Group,{className:"mb-3",children:[(0,b.jsxs)(ce.A.Label,{children:[l("changePasswordModal.confirmPassword")," *"]}),(0,b.jsxs)("div",{className:De,children:[(0,b.jsx)(ce.A.Control,{type:g.confirm?"text":"password",name:"confirmPassword",value:r.confirmPassword,onChange:P,placeholder:l("changePasswordModal.confirmPasswordPlaceholder"),isInvalid:!!v.confirmPassword,disabled:h}),(0,b.jsx)(i.A,{type:"button",variant:"outline-secondary",className:Ue,onClick:()=>w("confirm"),disabled:h,children:g.confirm?(0,b.jsx)(d.mx3,{}):(0,b.jsx)(d.Ny1,{})})]}),v.confirmPassword&&(0,b.jsx)(ce.A.Control.Feedback,{type:"invalid",children:v.confirmPassword})]}),(0,b.jsxs)("div",{className:Be,children:[(0,b.jsx)(i.A,{variant:"secondary",onClick:j,disabled:h,children:l("changePasswordModal.cancel")}),(0,b.jsx)(i.A,{variant:"primary",type:"submit",disabled:h||A,children:l(h?"changePasswordModal.changing":"changePasswordModal.changePassword")})]})]})]})]})};var He=a(8816);const Re={container:"ProfileSettings_container__QY7tW",section:"ProfileSettings_section__3E1Dv",sectionTitle:"ProfileSettings_sectionTitle__upL6e",settingItem:"ProfileSettings_settingItem__-vF4k",actionButton:"ProfileSettings_actionButton__mg8UL",deleteBtn:"ProfileSettings_deleteBtn__zM+m0",logoutBtn:"ProfileSettings_logoutBtn__1oc4G",infoLink:"ProfileSettings_infoLink__SjjjJ",switch:"ProfileSettings_switch__kKXMs",slider:"ProfileSettings_slider__nuCIY"},Oe=e=>{var s,a,o,l,t,i,u,g,m,f;let{profileData:p,onUpdate:x,onLogout:v,onDeleteAccount:_}=e;const{t:j}=(0,c.Bd)(),[P,w]=(0,n.useState)(!1),[A,N]=(0,n.useState)(!1),[y,C]=(0,n.useState)({email:null===(s=null===p||void 0===p||null===(a=p.settings)||void 0===a||null===(o=a.notifications)||void 0===o?void 0:o.email)||void 0===s||s});console.log("[ProfileSettings] Renderizzato con showLocationOnMap:",null===p||void 0===p||null===(l=p.settings)||void 0===l||null===(t=l.privacy)||void 0===t?void 0:t.showLocationOnMap);const[k,M]=(0,n.useState)(null!==(i=null===p||void 0===p||null===(u=p.settings)||void 0===u||null===(g=u.privacy)||void 0===g?void 0:g.showLocationOnMap)&&void 0!==i&&i);if((0,n.useEffect)(()=>{var e,s,a;M(null!==(e=null===p||void 0===p||null===(s=p.settings)||void 0===s||null===(a=s.privacy)||void 0===a?void 0:a.showLocationOnMap)&&void 0!==e&&e)},[null===p||void 0===p||null===(m=p.settings)||void 0===m||null===(f=m.privacy)||void 0===f?void 0:f.showLocationOnMap]),!p)return null;return(0,b.jsxs)("div",{className:Re.container,children:[(0,b.jsx)("h2",{children:j("profile.settings.title")}),(0,b.jsxs)("div",{className:Re.section,children:[(0,b.jsxs)("h3",{className:Re.sectionTitle,children:[(0,b.jsx)(d.jNV,{})," ",j("profile.settings.notifications")]}),(0,b.jsxs)("div",{className:Re.settingItem,children:[(0,b.jsx)("p",{children:j("profile.settings.emailNotifications")}),(0,b.jsxs)("label",{className:Re.switch,children:[(0,b.jsx)("input",{type:"checkbox",name:"email",checked:y.email,onChange:e=>{const{name:s,checked:a}=e.target,n=(0,W.A)((0,W.A)({},y),{},{[s]:a});C(n),x({settings:(0,W.A)((0,W.A)({},p.settings),{},{notifications:n})}),r.oR.info(j("profile.settings.notificationUpdated"))}}),(0,b.jsx)("span",{className:Re.slider})]})]})]}),(0,b.jsxs)("div",{className:Re.section,children:[(0,b.jsxs)("h3",{className:Re.sectionTitle,children:[(0,b.jsx)(d.JhU,{})," ",j("profile.settings.privacySecurity")]}),(0,b.jsxs)("div",{className:Re.settingItem,children:[(0,b.jsx)("p",{children:j("profile.settings.enableLocation")}),(0,b.jsxs)("label",{className:Re.switch,children:[(0,b.jsx)("input",{type:"checkbox",checked:k,onChange:()=>{const e=!k;M(e),x({settings:(0,W.A)((0,W.A)({},p.settings),{},{privacy:(0,W.A)((0,W.A)({},p.settings.privacy),{},{showLocationOnMap:e})})}),r.oR.info(j("profile.settings.locationUpdated"))}}),(0,b.jsx)("span",{className:Re.slider})]})]}),(0,b.jsxs)("button",{className:Re.actionButton,onClick:()=>N(!0),children:[(0,b.jsx)(d.pXu,{})," ",j("profile.settings.changePassword")]}),(0,b.jsxs)("p",{className:Re.infoLink,children:[(0,b.jsx)(d.__w,{})," ",j("profile.settings.privacyPolicyInfo"),"             ",(0,b.jsx)(h.N_,{to:"/privacy",className:Re.footerLink,children:"Privacy Policy"})]})]}),(0,b.jsxs)("div",{className:Re.section,children:[(0,b.jsxs)("h3",{className:Re.sectionTitle,children:[(0,b.jsx)(d.axc,{})," ",j("profile.settings.account")]}),(0,b.jsx)("button",{className:"".concat(Re.actionButton," ").concat(Re.logoutBtn),onClick:()=>{window.confirm(j("profile.settings.logoutConfirm"))&&v()},children:j("profile.settings.logout")}),(0,b.jsxs)("button",{className:"".concat(Re.actionButton," ").concat(Re.deleteBtn),onClick:()=>{w(!0)},children:[(0,b.jsx)(d.qbC,{})," ",j("profile.settings.deleteAccount")]})]}),(0,b.jsx)(ye,{show:P,onHide:()=>w(!1),onDeleteAccount:async e=>{try{await _(e),r.oR.success(j("profile.settings.accountDeleted"))}catch(n){var s,a;throw r.oR.error((null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||j("profile.settings.deleteError")),n}},user:p}),(0,b.jsx)(Ee,{show:A,onHide:()=>N(!1),onChangePassword:async(e,s)=>{try{await He.Ay.changePassword({currentPassword:e,newPassword:s}),r.oR.success(j("changePasswordModal.changeSuccess"))}catch(a){throw a}}})]})};var Te=a(7352);const ze="ProfilePage_profilePage__wWyty",qe="ProfilePage_header__Ec2+T",Ke="ProfilePage_smallBackButton__lPn3c",Fe="ProfilePage_content__vAvd-",Ge="ProfilePage_welcomePage__eUzgV",We="ProfilePage_title__aokUu",Ye="ProfilePage_subtitle__YhcYH",Je="ProfilePage_benefitsGrid__BHvOA",Ze="ProfilePage_benefitCard__wSQel",Qe="ProfilePage_icon__3huN0",Ve="ProfilePage_cardTitle__-ZoW-",Xe="ProfilePage_cardText__6oCPk",$e=()=>{const{t:e}=(0,c.Bd)(),{user:s,updateUser:a,loading:h,logout:f,deleteAccount:p}=(0,u.A)(),[x,v]=(0,n.useState)(null),[_,j]=(0,n.useState)(!0),[P,w]=(0,n.useState)(!1),[A,N]=(0,n.useState)(""),M=n.useRef(!1),S=n.useRef(!1),I=(0,n.useCallback)(async()=>{if(console.log("[ProfilePage] loadProfile chiamato, user?.id:",null===s||void 0===s?void 0:s.id),null!==s&&void 0!==s&&s.id)if(S.current)console.log("[ProfilePage] \u26a0\ufe0f Caricamento gi\xe0 in corso, salto");else try{S.current=!0,j(!0),N(""),console.log("[ProfilePage] Caricamento profilo per user ID:",s.id);const e=await g.A.getProfile();console.log("[ProfilePage] Profilo caricato:",{hasData:!!e,userId:null===e||void 0===e?void 0:e.id,nickname:null===e||void 0===e?void 0:e.nickname}),v(e),!e||M.current&&JSON.stringify(e)===JSON.stringify(s)||(a(e),M.current=!0)}catch(c){var n,o,l,t,i,r;console.error("[ProfilePage] \u274c Errore nel caricamento profilo:",{message:c.message,status:null===c||void 0===c||null===(n=c.response)||void 0===n?void 0:n.status,statusText:null===c||void 0===c||null===(o=c.response)||void 0===o?void 0:o.statusText,data:null===c||void 0===c||null===(l=c.response)||void 0===l?void 0:l.data});const s=(null===c||void 0===c||null===(t=c.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.message)||c.message||e("profile.loadError");N(s),401===(null===c||void 0===c||null===(r=c.response)||void 0===r?void 0:r.status)&&console.warn("[ProfilePage] \u26a0\ufe0f Errore 401, potrebbe essere necessario fare logout")}finally{j(!1),S.current=!1}else console.warn("[ProfilePage] \u26a0\ufe0f User ID non presente, salto il caricamento")},[null===s||void 0===s?void 0:s.id,e]);(0,n.useEffect)(()=>{null===s||void 0===s||!s.id||M.current||S.current||(console.log("[ProfilePage] useEffect: Caricamento profilo per user:",s.id),I())},[null===s||void 0===s?void 0:s.id]);const L=async n=>{w(!0);try{const o=await g.A.updateProfile(n);v(o),a(o),r.oR.success(e("profile.updateSuccess")),s.profileCompleted}catch(t){var o,l;r.oR.error((null===(o=t.response)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.message)||e("profile.updateError"))}finally{w(!1)}},D=async s=>{w(!0);try{console.log("\ud83d\uddbc\ufe0f [Profile] Inizio upload immagine profilo...");const n=await g.A.updateProfileImage(s);console.log("\u2705 [Profile] Immagine profilo aggiornata:",n),v(n),a(n),r.oR.success(e("profile.imageUpdateSuccess")||"Immagine profilo aggiornata con successo!")}catch(l){var n,o;console.error("\u274c [Profile] Errore upload immagine:",l),r.oR.error((null===(n=l.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message)||e("profile.imageUpdateError")||"Errore durante l'aggiornamento dell'immagine")}finally{w(!1)}};if(console.log("[ProfilePage] Render - authLoading:",h,"user:",!!s,"loading:",_,"error:",A,"profileData:",!!x),h)return console.log("[ProfilePage] Mostrando spinner per authLoading"),(0,b.jsx)(o.A,{fullscreen:!0,label:e("common.loading")||"Caricamento..."});if(!s)return console.log("[ProfilePage] Nessun utente, mostrando errore"),(0,b.jsx)(l.A,{children:(0,b.jsx)(t.A,{variant:"warning",children:e("profile.notAuthenticated")||"Devi essere autenticato per visualizzare il profilo."})});if(_)return console.log("[ProfilePage] Mostrando spinner per loading"),(0,b.jsx)(o.A,{fullscreen:!0,label:e("common.loadingProfile")||"Caricamento profilo..."});if(A)return console.log("[ProfilePage] Mostrando errore:",A),(0,b.jsxs)(l.A,{children:[(0,b.jsx)(t.A,{variant:"danger",children:A}),(0,b.jsx)(i.A,{onClick:()=>{M.current=!1,I()},className:"mt-3",children:e("common.retry")||"Riprova"})]});if(s&&!s.profileCompleted)return(0,b.jsxs)("div",{className:Ge,children:[(0,b.jsxs)("div",{className:qe,children:[(0,b.jsx)("h1",{className:We,children:"Un ultimo passo!"}),(0,b.jsx)("p",{className:Ye,children:"Completa il tuo profilo per rendere la tua esperienza su TableTalk unica."})]}),(0,b.jsxs)("div",{className:Je,children:[(0,b.jsxs)("div",{className:Ze,children:[(0,b.jsx)(d.YXz,{className:Qe,size:40}),(0,b.jsx)("h3",{className:Ve,children:"Trova le Persone Giuste"}),(0,b.jsx)("p",{className:Xe,children:"Aggiungendo i tuoi interessi, ti aiuteremo a trovare pasti con persone simili a te."})]}),(0,b.jsxs)("div",{className:Ze,children:[(0,b.jsx)(d.kqk,{className:Qe,size:40}),(0,b.jsx)("h3",{className:Ve,children:"Fai una Bella Impressione"}),(0,b.jsx)("p",{className:Xe,children:"Una bio e una foto profilo aiutano gli altri a conoscerti meglio prima di un pasto."})]}),(0,b.jsxs)("div",{className:Ze,children:[(0,b.jsx)(d.A7C,{className:Qe,size:40}),(0,b.jsx)("h3",{className:Ve,children:"Ottieni Pi\xf9 Inviti"}),(0,b.jsx)("p",{className:Xe,children:"I profili completi hanno il 75% in pi\xf9 di probabilit\xe0 di essere invitati a pasti esclusivi."})]})]}),(0,b.jsx)("div",{className:ze,style:{paddingTop:"2rem"},children:(0,b.jsxs)("div",{className:Fe,children:[(0,b.jsx)(y,{profile:x||s,onUpdateImage:D,isEditing:!0}),(0,b.jsx)(C.A,{profileData:x||s,onUpdate:L,isUpdating:P}),(0,b.jsx)(k.A,{profileData:x||s,onUpdate:L,isUpdating:P})]})})]});const U=x||s;return console.log("[ProfilePage] displayData:",!!U,"user.profileCompleted:",null===s||void 0===s?void 0:s.profileCompleted),U?(console.log("[ProfilePage] Renderizzando pagina profilo completa"),(0,b.jsx)(m.Ay,{componentName:"ProfilePage",children:(0,b.jsxs)(l.A,{fluid:!0,className:ze,style:{minHeight:"100vh",backgroundColor:"#f8f9fa"},children:[(0,b.jsx)("div",{className:qe,children:(0,b.jsx)(Te.A,{className:Ke})}),(0,b.jsxs)("div",{className:Fe,children:[(0,b.jsx)(y,{profile:U,onUpdateImage:D}),(0,b.jsx)(C.A,{profileData:U,onUpdate:L,isUpdating:P}),(0,b.jsx)(k.A,{profileData:U,onUpdate:L,isUpdating:P}),(0,b.jsx)(G,{profileData:U,onUpdate:L,isUpdating:P}),(0,b.jsx)(Oe,{profileData:U,onUpdate:L,onLogout:f,onDeleteAccount:p})]})]})})):(console.log("[ProfilePage] Nessun displayData disponibile"),(0,b.jsxs)(l.A,{children:[(0,b.jsx)(t.A,{variant:"warning",children:e("profile.noData")||"Impossibile caricare i dati del profilo."}),(0,b.jsx)(i.A,{onClick:()=>{M.current=!1,I()},className:"mt-3",children:e("common.retry")||"Riprova"})]}))}},8466:(e,s,a)=>{a.d(s,{A:()=>n});const n=a(5043).createContext(null)},9048:(e,s,a)=>{a.d(s,{A:()=>o});const n=a(5043).createContext(null);n.displayName="NavContext";const o=n}}]);
//# sourceMappingURL=214.c24cca55.chunk.js.map