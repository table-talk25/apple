"use strict";(self.webpackChunktable_talk_client=self.webpackChunktable_talk_client||[]).push([[784],{549:(e,t,a)=>{a.d(t,{A:()=>f});var i=a(5043),n=a(9896),o=a(9419),s=a(6036),l=a(3318),r=a(2023),c=a(228),m=a.n(c),d=(a(6433),a(579));function p(e){let{position:t,zoom:a}=e;const o=(0,n.ko)();return(0,i.useEffect)(()=>{if(t&&t.lat&&t.lng){const e=a||o.getZoom();o.flyTo([t.lat,t.lng],e,{duration:1.5})}},[null===t||void 0===t?void 0:t.lat,null===t||void 0===t?void 0:t.lng,a,o]),null}function u(e){let{center:t,zoom:a}=e;const o=(0,n.ko)();return(0,i.useEffect)(()=>{if(t&&Array.isArray(t)&&2===t.length){const[e,i]=t,n=a||o.getZoom();o.flyTo([e,i],n,{duration:1.5})}},[t,a,o]),null}function h(e){let{onLocationSelect:t,onMapClick:a}=e;return(0,n.Po)({click(e){const{lat:i,lng:n}=e.latlng;a&&a(),t&&t({lat:i,lng:n})}}),null}delete m().Icon.Default.prototype._getIconUrl,m().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const f=e=>{let{meals:t=[],markers:a=[],onLocationSelect:n,onMarkerClick:c,onMapClick:f,selectedLocation:g,userLocation:x=null,zoom:b=13,height:y="400px",width:v="100%",center:j=[45.4642,9.19]}=e;return(0,i.useEffect)(()=>{"undefined"===typeof window||window.L?console.log("\u2705 [Map] Leaflet caricato correttamente"):console.error("\u274c [Map] Leaflet non \xe8 disponibile")},[]),(0,d.jsx)("div",{style:{width:"100%",height:"100%",position:"relative"},children:(0,d.jsxs)(o.W,{center:j,zoom:b,style:{height:y,width:v,borderRadius:"8px"},whenReady:()=>{console.log("\u2705 [Map] Mappa Leaflet pronta")},whenCreated:e=>{console.log("\u2705 [Map] Istanza mappa creata")},children:[(0,d.jsx)(r.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',errorTileUrl:"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='256' height='256'%3E%3Crect fill='%23ddd' width='256' height='256'/%3E%3Ctext fill='%23999' font-family='sans-serif' font-size='18' x='50%25' y='50%25' text-anchor='middle' dominant-baseline='middle'%3EErrore caricamento mappa%3C/text%3E%3C/svg%3E"}),(0,d.jsx)(u,{center:j,zoom:b}),(0,d.jsx)(h,{onLocationSelect:n,onMapClick:f}),g&&(0,d.jsx)(p,{position:g,zoom:b}),x&&(0,d.jsx)(s.p,{position:[x.lat,x.lng],icon:m().icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),children:(0,d.jsxs)(l.z,{children:["\ud83d\udccd ",(0,d.jsx)("strong",{children:"La tua posizione"})]})}),g&&(0,d.jsx)(s.p,{position:[g.lat,g.lng],children:(0,d.jsxs)(l.z,{children:["\ud83d\udccd ",(0,d.jsx)("strong",{children:"Posizione selezionata"}),(0,d.jsx)("br",{}),g.address||"".concat(g.lat.toFixed(4),", ").concat(g.lng.toFixed(4))]})}),a.map(e=>(0,d.jsx)(s.p,{position:[e.lat,e.lng],eventHandlers:{click:()=>{c&&c(e.id)}},children:(0,d.jsx)(l.z,{children:(0,d.jsxs)("div",{style:{minWidth:"200px"},children:[(0,d.jsxs)("h3",{style:{margin:"0 0 8px 0",color:"#FF6B35"},children:["\ud83c\udf7d\ufe0f ",e.title||e.name]}),e.price&&(0,d.jsxs)("p",{style:{margin:"4px 0"},children:["\ud83d\udcb0 \u20ac",e.price]}),e.type&&(0,d.jsxs)("p",{style:{margin:"4px 0",color:"#666"},children:["\ud83d\udcc5 ",e.type]})]})})},e.id)),t.map(e=>(0,d.jsx)(s.p,{position:[e.lat,e.lng],eventHandlers:{click:()=>{c&&c(e.id)}},children:(0,d.jsx)(l.z,{children:(0,d.jsxs)("div",{style:{minWidth:"200px"},children:[(0,d.jsxs)("h3",{style:{margin:"0 0 8px 0",color:"#FF6B35"},children:["\ud83c\udf7d\ufe0f ",e.name]}),(0,d.jsxs)("p",{style:{margin:"4px 0"},children:["\ud83d\udccd ",e.restaurant||e.address]}),(0,d.jsxs)("p",{style:{margin:"4px 0"},children:["\ud83d\udc65 ",e.participants||0," partecipanti"]}),(0,d.jsxs)("p",{style:{margin:"4px 0"},children:["\ud83d\udcc5 ",e.date]}),(0,d.jsx)("button",{onClick:()=>window.open("/meal/".concat(e.id),"_blank"),style:{background:"#FF6B35",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",marginTop:"8px"},children:"Partecipa al TableTalk"})]})})},e.id))]})})}},1072:(e,t,a)=>{a.d(t,{A:()=>p});var i=a(2555),n=a(45),o=a(8139),s=a.n(o),l=a(5043),r=a(7852),c=a(579);const m=["bsPrefix","className","as"],d=l.forwardRef((e,t)=>{let{bsPrefix:a,className:o,as:l="div"}=e,d=(0,n.A)(e,m);const p=(0,r.oU)(a,"row"),u=(0,r.gy)(),h=(0,r.Jm)(),f="".concat(p,"-cols"),g=[];return u.forEach(e=>{const t=d[e];let a;delete d[e],null!=t&&"object"===typeof t?({cols:a}=t):a=t;const i=e!==h?"-".concat(e):"";null!=a&&g.push("".concat(f).concat(i,"-").concat(a))}),(0,c.jsx)(l,(0,i.A)((0,i.A)({ref:t},d),{},{className:s()(o,p,...g)}))});d.displayName="Row";const p=d},7352:(e,t,a)=>{a.d(t,{A:()=>l});a(5043);var i=a(3216),n=a(184);const o="BackButton_backButton__hBNQM";var s=a(579);const l=e=>{let{className:t=""}=e;const a=(0,i.Zp)();return(0,s.jsxs)("button",{onClick:()=>{a(-1)},className:"".concat(o," ").concat(t),children:[(0,s.jsx)(n.QVr,{style:{marginRight:8}}),"Torna indietro"]})}},7777:(e,t,a)=>{a.d(t,{A:()=>L});var i=a(2555),n=a(5043),o=a(8298),s=a(1072),l=a(8602),r=a(4282),c=a(7417),m=a(4117),d=a(5950);const p={form:"MealForm_form__iyuod",formGroup:"MealForm_formGroup__Nagwi",formLabel:"MealForm_formLabel__EuahF",formControl:"MealForm_formControl__QOV2v",dateInputContainer:"MealForm_dateInputContainer__tCElf",dateHelperButton:"MealForm_dateHelperButton__ypazG",formSelect:"MealForm_formSelect__qfqPi",formCheck:"MealForm_formCheck__GCWf7",typeSelector:"MealForm_typeSelector__mfJc5",typeButton:"MealForm_typeButton__KyHCF",active:"MealForm_active__Hpn7f",typeIcon:"MealForm_typeIcon__XJPIu",typeText:"MealForm_typeText__7CnAo",typeDescription:"MealForm_typeDescription__t2zNS",typeInfo:"MealForm_typeInfo__pB1+E",visibilitySelector:"MealForm_visibilitySelector__WKtUp",visibilityButton:"MealForm_visibilityButton__D2Hp1",visibilityIcon:"MealForm_visibilityIcon__FlV5b",visibilityText:"MealForm_visibilityText__dnQrt",visibilityDescription:"MealForm_visibilityDescription__FL8e4",visibilityInfo:"MealForm_visibilityInfo__-fbWG",mapContainer:"MealForm_mapContainer__whBqK",locationInfo:"MealForm_locationInfo__hHdUX",submitButton:"MealForm_submitButton__fUBD0",stickyActions:"MealForm_stickyActions__wBnhW",cancelButton:"MealForm_cancelButton__thg-a",error:"MealForm_error__TbffJ",success:"MealForm_success__pUq4n",loading:"MealForm_loading__6DqYq"},u="TopicInput_topicInputContainer__NfIJd",h="TopicInput_topicTag__HTw1U",f="TopicInput_removeTagButton__sDCPm",g="TopicInput_topicInput__WbbZc",x="TopicInput_inputError__VAq+v",b="TopicInput_hasError__0Xkbf",y="TopicInput_errorMessage__leuM0";var v=a(579);const j=e=>{let{topics:t,setTopics:a,onValidationChange:i}=e;const[o,s]=(0,n.useState)(""),[l,r]=(0,n.useState)("");(0,n.useEffect)(()=>{c()},[]),(0,n.useEffect)(()=>{if(i){const e=t.length>0&&t.every(e=>{const t=e.trim();return t.length>=2&&t.length<=50&&!/^\s+$/.test(t)});i(e)}},[t,i]);const c=()=>{if(!Array.isArray(t)||0===t.length)return;const e=t.filter(e=>{if("string"!==typeof e)return!1;const t=e.trim();return t.length>=2&&t.length<=50&&!/^\s+$/.test(t)&&!/^[^\w\s]+$/.test(t)&&/^[\w\s\u00C0-\u017F]+$/i.test(t)});e.length!==t.length&&(console.log("\ud83e\uddf9 [TopicInput] Puliti ".concat(t.length-e.length," argomenti non validi")),a(e))};return(0,v.jsxs)("div",{className:"".concat(u," ").concat(l?b:""),children:[t.map((e,i)=>(0,v.jsxs)("div",{className:h,children:[e,(0,v.jsx)("button",{type:"button",className:f,onClick:()=>{return i=e,void a(t.filter(e=>e!==i));var i},children:"\xd7"})]},i)),(0,v.jsx)("input",{type:"text",value:o,onChange:e=>{s(e.target.value),l&&r("")},onKeyDown:e=>{if("Enter"===e.key||","===e.key){e.preventDefault();const i=(e=>{if("string"!==typeof e)return{isValid:!1,error:"L'argomento deve essere una stringa valida"};const a=e.trim();return a.length<2?{isValid:!1,error:"L'argomento deve essere di almeno 2 caratteri"}:a.length>50?{isValid:!1,error:"L'argomento non pu\xf2 superare i 50 caratteri"}:t.some(e=>e.toLowerCase()===a.toLowerCase())?{isValid:!1,error:"Questo argomento \xe8 gi\xe0 presente"}:/^\s+$/.test(a)?{isValid:!1,error:"L'argomento non pu\xf2 contenere solo spazi"}:/^[\w\s\u00C0-\u017F]+$/i.test(a)?{isValid:!0,topic:a}:{isValid:!1,error:"L'argomento pu\xf2 contenere solo lettere, numeri e spazi"}})(o);if(i.isValid)if(t.length<5)a([...t,i.topic]),s(""),r("");else{const e="Limite massimo di 5 argomenti raggiunto";console.warn("\u26a0\ufe0f [TopicInput] ".concat(e)),r(e)}else console.warn("\u26a0\ufe0f [TopicInput] Argomento non valido: ".concat(i.error)),r(i.error)}},placeholder:t.length<5?"Aggiungi un argomento...":"Massimo 5 argomenti",className:"".concat(g," ").concat(l?x:""),disabled:t.length>=5}),l&&(0,v.jsxs)("div",{className:y,children:["\u26a0\ufe0f ",l]})]})};var _=a(549),A=a(8993);const N=["Italiano","English","Espa\xf1ol","Fran\xe7ais","Deutsch","\u4e2d\u6587","\u0627\u0644\u0639\u0631\u0628\u064a\u0629"],L=e=>{var t;let{initialData:a,onSubmit:u,onCancel:h,isLoading:f,isSubmitting:g,submitButtonText:x}=e;const{t:b}=(0,m.Bd)(),y=[{value:30,label:b("meals.form.durationOptions.30min")},{value:60,label:b("meals.form.durationOptions.1hour")},{value:90,label:b("meals.form.durationOptions.1hour30")},{value:120,label:b("meals.form.durationOptions.2hours")},{value:150,label:b("meals.form.durationOptions.2hours30")},{value:180,label:b("meals.form.durationOptions.3hours")}],[L,T]=(0,n.useState)((()=>{const e=new Date,t=new Date(e.getTime()+36e5),a=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return{title:"",description:"",mealType:"virtual",type:"lunch",date:"".concat(a,"-").concat(i,"-").concat(n,"T").concat(o,":").concat(s),duration:60,maxParticipants:2,language:"English",topics:[],location:null,isPublic:!0,estimatedCost:""}})()),[w,S]=(0,n.useState)(null),[C,M]=(0,n.useState)(null),[D,F]=(0,n.useState)(""),[k,I]=(0,n.useState)({}),[z,E]=(0,n.useState)(null);(0,n.useEffect)(()=>{L.location&&L.location.coordinates&&E({lat:L.location.coordinates[1],lng:L.location.coordinates[0],address:L.location.address})},[L.location]);const B=(e,t)=>{switch(e){case"title":if(!t.trim())return b("meals.form.titleRequired");if(t.trim().length<5)return b("meals.form.titleMinLength");if(t.trim().length>50)return b("meals.form.titleMaxLength");if((0,A.$J)(t))return"Il titolo contiene contenuto non permesso (HTML/JavaScript)";break;case"description":if(!t.trim())return b("meals.form.descriptionRequired");if(t.trim().length<10)return b("meals.form.descriptionMinLength");if(t.trim().length>1e3)return b("meals.form.descriptionMaxLength");if((0,A.$J)(t))return"La descrizione contiene contenuto non permesso (HTML/JavaScript)";break;case"date":if(!t)return b("meals.form.dateRequired");const e=new Date(t),a=new Date,i=3e5;if(e<new Date(a.getTime()-i))return b("meals.form.datePast")||"La data deve essere nel futuro";if(e>new Date(a.getFullYear()+1,a.getMonth(),a.getDate()))return b("meals.form.dateTooFar")||"La data non pu\xf2 essere pi\xf9 di un anno nel futuro";break;case"maxParticipants":if(!t||t<2)return b("meals.form.maxParticipantsMin");if(t>10)return b("meals.form.maxParticipantsMax");break;case"topics":default:return"";case"location":if("physical"===L.mealType&&!t)return b("meals.form.locationRequired")}return""},P=e=>{const{name:t,value:a}=e.target;if("date"===t&&a){const e=new Date(a),t=new Date,n=3e5;if(e<new Date(t.getTime()-n))return console.warn("\u26a0\ufe0f [MealForm] Data nel passato selezionata, reset campo"),T(e=>(0,i.A)((0,i.A)({},e),{},{date:""})),void I(e=>(0,i.A)((0,i.A)({},e),{},{date:b("meals.form.datePast")||"La data deve essere nel futuro"}))}T(e=>(0,i.A)((0,i.A)({},e),{},{[t]:a}));const n=B(t,a);I(e=>(0,i.A)((0,i.A)({},e),{},{[t]:n}))},O=e=>{const{name:t,value:a}=e.target,n=B(t,a);I(e=>(0,i.A)((0,i.A)({},e),{},{[t]:n}))},R=async function(e){let{maxWidth:t=1600,quality:a=.7}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const i=await createImageBitmap(e),n=Math.min(1,t/i.width),o=Math.round(i.width*n),s=Math.round(i.height*n),l=document.createElement("canvas");l.width=o,l.height=s;l.getContext("2d").drawImage(i,0,0,o,s);const r=l.toDataURL("image/jpeg",a),c=await fetch(r);return await c.blob()}catch(i){return e}},U=e=>new Promise((t,a)=>{try{const i=new FileReader;i.onloadend=()=>t(i.result),i.onerror=a,i.readAsDataURL(e)}catch(i){a(i)}});return(0,v.jsxs)(o.A,{onSubmit:e=>{if(e.preventDefault(),L.date){const e=new Date(L.date),t=new Date,a=3e5;if(e<new Date(t.getTime()-a))return console.warn("\u26a0\ufe0f [MealForm] Submit bloccato: data nel passato rilevata"),void I(e=>(0,i.A)((0,i.A)({},e),{},{date:b("meals.form.datePast")||"La data deve essere nel futuro"}))}const t={};if(Object.keys(L).forEach(e=>{const a=B(e,L[e]);a&&(t[e]=a)}),Object.keys(t).length>0)return void I(t);const a=(0,A.nB)(L);const n=new FormData,o=(0,i.A)({},a);o.date&&(o.date=new Date(o.date).toISOString());for(const i in o)"topics"===i&&Array.isArray(o[i])?o[i].forEach(e=>n.append("topics",e)):"location"===i&&o[i]?n.append("location",JSON.stringify(o[i])):"location"===i&&"physical"!==L.mealType||n.append(i,o[i]);w&&(n.append("image",w),D&&n.append("imageBase64",D),C&&n.append("imageLocalUri",C)),u(n)},className:p.form,children:[(0,v.jsxs)("div",{className:p.formGroup,children:[(0,v.jsx)("label",{className:p.formLabel,children:b("meals.form.typeLabel")}),(0,v.jsxs)("div",{className:p.typeSelector,children:[(0,v.jsxs)("button",{type:"button",className:"".concat(p.typeButton," ").concat("virtual"===L.mealType?p.active:""),onClick:()=>T((0,i.A)((0,i.A)({},L),{},{mealType:"virtual",location:null})),children:[(0,v.jsx)("span",{className:p.typeIcon,children:"\ud83c\udfa5"}),(0,v.jsx)("span",{className:p.typeText,children:b("meals.form.virtualType")}),(0,v.jsx)("small",{className:p.typeDescription,children:b("meals.form.virtualDescription")})]}),(0,v.jsxs)("button",{type:"button",className:"".concat(p.typeButton," ").concat("physical"===L.mealType?p.active:""),onClick:()=>T((0,i.A)((0,i.A)({},L),{},{mealType:"physical"})),children:[(0,v.jsx)("span",{className:p.typeIcon,children:"\ud83d\udccd"}),(0,v.jsx)("span",{className:p.typeText,children:b("meals.form.physicalType")}),(0,v.jsx)("small",{className:p.typeDescription,children:b("meals.form.physicalDescription")})]})]}),(0,v.jsx)("div",{className:p.typeInfo,children:"virtual"===L.mealType?b("meals.form.virtualInfo"):b("meals.form.physicalInfo")})]}),"physical"===L.mealType&&(0,v.jsxs)("div",{className:p.formGroup,children:[(0,v.jsx)("label",{className:p.formLabel,children:b("meals.form.visibilityLabel")}),(0,v.jsxs)("div",{className:p.visibilitySelector,children:[(0,v.jsxs)("button",{type:"button",className:"".concat(p.visibilityButton," ").concat(L.isPublic?p.active:""),onClick:()=>T((0,i.A)((0,i.A)({},L),{},{isPublic:!0})),children:[(0,v.jsx)("span",{className:p.visibilityIcon,children:"\ud83c\udf0d"}),(0,v.jsx)("span",{className:p.visibilityText,children:b("meals.form.publicVisibility")}),(0,v.jsx)("small",{className:p.visibilityDescription,children:b("meals.form.publicDescription")})]}),(0,v.jsxs)("button",{type:"button",className:"".concat(p.visibilityButton," ").concat(L.isPublic?"":p.active),onClick:()=>T((0,i.A)((0,i.A)({},L),{},{isPublic:!1})),children:[(0,v.jsx)("span",{className:p.visibilityIcon,children:"\ud83d\udd12"}),(0,v.jsx)("span",{className:p.visibilityText,children:b("meals.form.privateVisibility")}),(0,v.jsx)("small",{className:p.visibilityDescription,children:b("meals.form.privateDescription")})]})]}),(0,v.jsx)("div",{className:p.visibilityInfo,children:L.isPublic?b("meals.form.publicInfo"):b("meals.form.privateInfo")})]}),(0,v.jsxs)(o.A.Group,{className:"mb-3",children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.titleLabel")}),(0,v.jsx)(o.A.Control,{className:"".concat(p.formControl," ").concat(k.title?"is-invalid":""),type:"text",name:"title",value:L.title,onChange:P,onBlur:O,required:!0}),k.title&&(0,v.jsx)("div",{className:"invalid-feedback",children:k.title})]}),(0,v.jsxs)(o.A.Group,{className:"mb-3",children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.descriptionLabel")}),(0,v.jsx)(o.A.Control,{className:"".concat(p.formControl," ").concat(k.description?"is-invalid":""),as:"textarea",rows:3,name:"description",value:L.description,onChange:P,onBlur:O,required:!0}),k.description&&(0,v.jsx)("div",{className:"invalid-feedback",children:k.description})]}),(0,v.jsxs)(s.A,{className:"mb-3",children:[(0,v.jsx)(l.A,{md:6,children:(0,v.jsxs)(o.A.Group,{children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.categoryLabel")}),(0,v.jsxs)(o.A.Select,{className:p.formSelect,name:"type",value:L.type,onChange:P,required:!0,children:[(0,v.jsx)("option",{value:"",disabled:!0,children:b("meals.form.selectCategory")}),d.oD.map(e=>(0,v.jsx)("option",{value:e.value,children:e.label},e.value))]})]})}),(0,v.jsx)(l.A,{md:6,children:(0,v.jsxs)(o.A.Group,{children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.maxParticipantsLabel")}),(0,v.jsx)(o.A.Control,{className:"".concat(p.formControl," ").concat(k.maxParticipants?"is-invalid":""),type:"number",name:"maxParticipants",value:L.maxParticipants,onChange:P,onBlur:O,required:!0,min:"2",max:"10"}),k.maxParticipants&&(0,v.jsx)("div",{className:"invalid-feedback",children:k.maxParticipants})]})})]}),(0,v.jsxs)(s.A,{className:"mb-3",children:[(0,v.jsx)(l.A,{xs:12,md:6,children:(0,v.jsxs)(o.A.Group,{children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.languageLabel")}),(0,v.jsx)(o.A.Select,{className:p.formSelect,name:"language",value:L.language,onChange:P,required:!0,children:N.map(e=>(0,v.jsx)("option",{value:e,children:e},e))})]})}),(0,v.jsx)(l.A,{xs:12,md:6,children:(0,v.jsxs)(o.A.Group,{children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.durationLabel")}),(0,v.jsx)(o.A.Select,{className:p.formSelect,name:"duration",value:L.duration,onChange:P,required:!0,children:y.map(e=>(0,v.jsx)("option",{value:e.value,children:e.label},e.value))})]})})]}),"physical"===L.mealType&&(0,v.jsx)(s.A,{className:"mb-3",children:(0,v.jsx)(l.A,{md:6,children:(0,v.jsxs)(o.A.Group,{children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.priceLabel")||"Prezzo Stimato (\u20ac)"}),(0,v.jsxs)("div",{className:"input-group",children:[(0,v.jsx)("span",{className:"input-group-text",children:"\u20ac"}),(0,v.jsx)(o.A.Control,{className:p.formControl,type:"number",name:"estimatedCost",value:L.estimatedCost,onChange:P,placeholder:"Es. 25",min:"0"})]}),(0,v.jsx)(o.A.Text,{className:"text-muted",children:"Costo medio a persona (solo indicativo)"})]})})}),(0,v.jsxs)(s.A,{className:"mb-3",children:[(0,v.jsx)(l.A,{xs:12,md:6,children:(0,v.jsxs)(o.A.Group,{children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.dateLabel")}),(0,v.jsxs)("div",{className:p.dateInputContainer,children:[(0,v.jsx)(o.A.Control,{className:"".concat(p.formControl," ").concat(k.date?"is-invalid":""),type:"datetime-local",name:"date",value:L.date,min:(()=>{const e=new Date,t=new Date(e.getTime()-3e5),a=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),o=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return"".concat(a,"-").concat(i,"-").concat(n,"T").concat(o,":").concat(s)})(),onChange:P,onBlur:O,required:!0}),(0,v.jsx)("button",{type:"button",className:p.dateHelperButton,onClick:()=>{const e=new Date,t=new Date(e.getTime()+36e5),a=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),l=String(t.getMinutes()).padStart(2,"0"),r="".concat(a,"-").concat(n,"-").concat(o,"T").concat(s,":").concat(l);T(e=>(0,i.A)((0,i.A)({},e),{},{date:r})),I(e=>(0,i.A)((0,i.A)({},e),{},{date:""}))},title:"Suggerisci data valida (1 ora da ora)",children:"\ud83d\udd50"})]}),k.date&&(0,v.jsx)("div",{className:"invalid-feedback",children:k.date}),(0,v.jsx)(o.A.Text,{className:"text-muted",children:"\ud83d\udcc5 Seleziona una data e ora nel futuro"})]})}),(0,v.jsx)(l.A,{xs:12,md:6,children:"physical"===L.mealType&&(0,v.jsxs)(o.A.Group,{children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.addressLabel")}),(0,v.jsx)(o.A.Control,{className:"".concat(p.formControl," ").concat(k.location?"is-invalid":""),type:"text",name:"location",value:(null===(t=L.location)||void 0===t?void 0:t.address)||"",onChange:P,onBlur:O,placeholder:b("meals.form.addressPlaceholder"),readOnly:!0}),k.location&&(0,v.jsx)("div",{className:"invalid-feedback",children:k.location}),(0,v.jsx)(o.A.Text,{className:"text-muted",children:"\ud83d\udccd L'indirizzo viene selezionato dalla mappa sottostante"})]})})]}),"physical"===L.mealType&&(0,v.jsxs)("div",{className:p.formGroup,children:[(0,v.jsx)("label",{children:"\ud83d\udccd Seleziona posizione del pasto:"}),(0,v.jsx)(_.A,{selectedLocation:z,onLocationSelect:e=>{E(e),T(t=>(0,i.A)((0,i.A)({},t),{},{location:{address:e.address||"".concat(e.lat.toFixed(4),", ").concat(e.lng.toFixed(4)),coordinates:[e.lng,e.lat]}})),I(e=>(0,i.A)((0,i.A)({},e),{},{location:null}))},height:"300px",center:z?[z.lat,z.lng]:L.location&&L.location.coordinates?[L.location.coordinates[1],L.location.coordinates[0]]:[45.4642,9.19]}),z&&(0,v.jsxs)("div",{className:"selected-location-info",style:{marginTop:"10px",padding:"10px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6"},children:["\u2705 ",(0,v.jsx)("strong",{children:"Posizione selezionata:"}),(0,v.jsx)("br",{}),(0,v.jsx)("span",{style:{fontSize:"14px",color:"#666"},children:z.address||"Lat: ".concat(z.lat.toFixed(4),", Lng: ").concat(z.lng.toFixed(4))})]})]}),(0,v.jsxs)(o.A.Group,{className:"mb-3",children:[(0,v.jsx)(o.A.Label,{className:p.formLabel,children:b("meals.form.topicsLabel")}),(0,v.jsx)(j,{topics:L.topics,setTopics:e=>{T(t=>(0,i.A)((0,i.A)({},t),{},{topics:e}));const t=B("topics",e);I(e=>(0,i.A)((0,i.A)({},e),{},{topics:t}))}}),k.topics&&(0,v.jsx)("div",{className:"invalid-feedback d-block",children:k.topics}),(0,v.jsx)(o.A.Text,{children:b("meals.form.topicsHelp")})]}),(0,v.jsxs)(o.A.Group,{className:"mb-3",children:[(0,v.jsx)(o.A.Label,{children:b("meals.form.coverImageLabel")}),C&&(0,v.jsx)("img",{src:C,alt:b("meals.form.coverImageAlt"),className:p.imagePreview}),(0,v.jsx)(o.A.Control,{type:"file",accept:"image/*",onChange:async e=>{const t=e.target.files[0];if(t)if(t.type.startsWith("image/"))if(t.size>10485760)alert("Il file \xe8 troppo grande. Massimo 10MB.");else try{const e=new FileReader;e.onload=e=>{M(e.target.result)},e.readAsDataURL(t);let i=t;if(t.size>4194304){const e=await R(t,{maxWidth:1600,quality:.7});i=new File([e],t.name,{type:"image/jpeg"})}S(i);try{const e=await U(i);"string"===typeof e&&F(e)}catch(a){}console.log("\ud83d\udcc1 File selezionato:",i.name,i.size)}catch(i){console.error("Errore elaborazione file",i)}else alert("Seleziona solo file immagine")},className:"mt-2",style:{fontSize:"0.9em"}}),(0,v.jsx)(o.A.Text,{className:"text-muted",children:"Seleziona un'immagine dal tuo dispositivo (max 10MB)"}),w&&(0,v.jsxs)("div",{className:"mt-2 p-2 bg-light rounded",style:{fontSize:"0.9em"},children:[(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,v.jsx)("span",{children:"\ud83d\udcf7 Immagine selezionata"}),(0,v.jsxs)("small",{className:"text-muted",children:[w.name," (",(w.size/1024/1024).toFixed(2)," MB)"]})]}),(0,v.jsx)("small",{className:"text-muted d-block mt-1",children:"L'immagine verr\xe0 caricata insieme al pasto"})]})]}),(0,v.jsx)("div",{className:p.stickyActions,children:(0,v.jsx)(r.A,{variant:"primary",type:"submit",className:p.submitButton,disabled:f||g,children:f||g?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(c.A,{as:"span",animation:"border",size:"sm"}),(0,v.jsxs)("span",{children:[" ",b(g?"meals.form.saving":"meals.form.loading")]})]}):x||b("forms.save")})})]})}},8993:(e,t,a)=>{a.d(t,{$J:()=>r,nB:()=>c});var i=a(2555),n=a(7977);const o={ALLOWED_TAGS:[],ALLOWED_ATTR:[],ALLOW_DATA_ATTR:!1,ALLOW_UNKNOWN_PROTOCOLS:!1,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_TRUSTED_TYPE:!1,KEEP_CONTENT:!1,IN_PLACE:!1,SANITIZE_DOM:!0,WHOLE_DOCUMENT:!1,RETURN_DOM_IMPORT:!1,FORCE_BODY:!1,SANITIZE_NAMED_PROPS:!1,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e||"string"!==typeof e)return"";try{const a=t?(0,i.A)((0,i.A)({},o),{},{ALLOWED_TAGS:["b","i","em","strong","u"],ALLOWED_ATTR:[]}):o;return n.A.sanitize(e,a)}catch(a){return console.error("\u274c [SanitizationService] Errore sanitizzazione:",a),""}},l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e||"object"!==typeof e)return e;const n=(0,i.A)({},e);return(t.length>0?t:Object.keys(e).filter(t=>"string"===typeof e[t])).forEach(e=>{n[e]&&"string"===typeof n[e]&&(n[e]=s(n[e],a))}),n},r=e=>{if(!e||"string"!==typeof e)return!1;return[/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,/<object\b[^<]*(?:(?!<\/object>)<[^<]*)*<\/object>/gi,/<embed\b[^<]*(?:(?!<\/embed>)<[^<]*)*<\/embed>/gi,/javascript:/gi,/vbscript:/gi,/data:/gi,/on\w+\s*=/gi,/<.*>/g].some(t=>t.test(e))},c=e=>l(e,["title","description","language","topics"],!1)}}]);
//# sourceMappingURL=784.340891fc.chunk.js.map