{"version":3,"file":"static/js/802.cdbe00c8.chunk.js","mappings":"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","sources":["webpack://table-talk-client/./src/components/common/BackButton/BackButton.module.css?c17f","components/common/BackButton/index.js","services/chatService.js","webpack://table-talk-client/./src/pages/ChatPage/ChatPage.module.css?88db","components/meals/LeaveReportModal.js","pages/ChatPage/index.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"backButton\":\"BackButton_backButton__hBNQM\"};","// File: src/components/common/BackButton/index.js\n\nimport React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { FaArrowLeft } from 'react-icons/fa';\nimport styles from './BackButton.module.css';\n\nconst BackButton = ({ className = '' }) => {\n  const navigate = useNavigate();\n\n  const handleBack = () => {\n    navigate(-1);\n  };\n\n  return (\n    <button onClick={handleBack} className={`${styles.backButton} ${className}`}>\n      <FaArrowLeft style={{ marginRight: 8 }} />\n      Torna indietro\n    </button>\n  );\n};\n\nexport default BackButton;","// File: FRONTEND/client/src/services/chatService.js (Corretto con apiService)\n\nimport apiClient from './apiService'; // <-- Usa il tuo servizio centralizzato\n\n/**\n * Ottiene i dati di una chat e la sua cronologia messaggi\n * @param {string} chatId - L'ID della chat da recuperare\n * @returns {Promise<Object>} L'oggetto della chat\n */\nconst getChatById = async (chatId) => {\n  try {\n    // ðŸ” Normalizza e valida chatId\n    let normalizedChatId = chatId;\n    \n    // Se Ã¨ un oggetto, estrai l'ID\n    if (typeof chatId === 'object' && chatId !== null) {\n      normalizedChatId = chatId._id || chatId.id || chatId.chatId || String(chatId);\n      console.warn('âš ï¸ [ChatService] chatId era un oggetto, normalizzato a:', normalizedChatId);\n    }\n    \n    // Converti in stringa e trim\n    normalizedChatId = String(normalizedChatId || '').trim();\n    \n    // Validazione finale\n    if (!normalizedChatId || normalizedChatId === 'undefined' || normalizedChatId === 'null' || normalizedChatId === '[object Object]') {\n      const error = new Error('chatId non valido: ricevuto un oggetto o valore vuoto');\n      console.error('âŒ [ChatService]', error.message, 'chatId originale:', chatId);\n      throw error;\n    }\n    \n    // ðŸ” Debug logs per tracciare le chiamate\n    console.log('ðŸ” [Frontend] Calling chat API with chatId:', normalizedChatId);\n    console.log('ðŸ” [Frontend] ChatId type:', typeof normalizedChatId, 'Length:', normalizedChatId?.length);\n    console.log('ðŸ” [Frontend] ChatId valid MongoDB format:', normalizedChatId?.match(/^[0-9a-fA-F]{24}$/) ? 'âœ… Valid' : 'âŒ Invalid');\n    \n    const response = await apiClient.get(`/chats/${normalizedChatId}`);\n    console.log('âœ… [Frontend] Chat API response received:', response.data);\n    console.log('ðŸ” [Frontend] Response structure:', {\n      hasData: !!response.data?.data,\n      hasChat: !!response.data?.chat,\n      hasMessages: !!response.data?.messages,\n      hasSuccess: !!response.data?.success,\n      keys: Object.keys(response.data || {})\n    });\n    \n    // Il backend restituisce: {success: true, chat: {...}, messages: [...]}\n    // Estraiamo la chat (che potrebbe essere in data, chat, o direttamente in response.data)\n    const chatData = response.data?.data || response.data?.chat || response.data;\n    \n    // Estraiamo i messaggi se presenti nella risposta separata\n    const messages = response.data?.messages || chatData?.messages || [];\n    \n    console.log('ðŸ” [Frontend] Chat data extracted:', chatData);\n    console.log('ðŸ” [Frontend] Messages extracted:', messages?.length || 0, 'messages');\n    \n    if (!chatData) {\n      throw new Error('Nessun dato chat ricevuto dalla risposta API');\n    }\n    \n    // Uniamo chat e messages in un unico oggetto per compatibilitÃ  con la ChatPage\n    return {\n      ...chatData,\n      messages: messages\n    };\n  } catch (error) {\n    console.error('ðŸ’¬ [ChatService] Error details:', {\n      message: error.message,\n      status: error.response?.status,\n      statusText: error.response?.statusText,\n      url: error.config?.url,\n      responseData: error.response?.data\n    });\n    throw error;\n  }\n};\n\n// Funzione helper per normalizzare chatId\nconst normalizeChatId = (chatId) => {\n  if (typeof chatId === 'object' && chatId !== null) {\n    return chatId._id || chatId.id || chatId.chatId || String(chatId);\n  }\n  return String(chatId || '').trim();\n};\n\n/**\n * Permette all'utente autenticato di lasciare una chat\n * @param {string} chatId - L'ID della chat da lasciare\n * @returns {Promise<Object>} La risposta dall'API\n */\nconst leaveChat = async (chatId) => {\n  const normalizedId = normalizeChatId(chatId);\n  const response = await apiClient.delete(`/chats/${normalizedId}/participants`, { suppressErrorAlert: true });\n  return response.data;\n};\n\nconst closeChat = async (chatId) => {\n  const normalizedId = normalizeChatId(chatId);\n  const response = await apiClient.put(`/chats/${normalizedId}/close`, {}, { suppressErrorAlert: true });\n  return response.data;\n};\n\n/**\n * Inizia l'indicatore \"sta scrivendo\"\n * @param {string} chatId - L'ID della chat\n * @returns {Promise<Object>} La risposta dall'API\n */\nconst startTyping = async (chatId) => {\n  const normalizedId = normalizeChatId(chatId);\n  const response = await apiClient.post(`/chats/${normalizedId}/typing/start`);\n  return response.data;\n};\n\n/**\n * Ferma l'indicatore \"sta scrivendo\"\n * @param {string} chatId - L'ID della chat\n * @returns {Promise<Object>} La risposta dall'API\n */\nconst stopTyping = async (chatId) => {\n  const normalizedId = normalizeChatId(chatId);\n  const response = await apiClient.post(`/chats/${normalizedId}/typing/stop`);\n  return response.data;\n};\n\n/**\n * Marca i messaggi come letti\n * @param {string} chatId - L'ID della chat\n * @returns {Promise<Object>} La risposta dall'API\n */\nconst markAsRead = async (chatId) => {\n  const normalizedId = normalizeChatId(chatId);\n  const response = await apiClient.post(`/chats/${normalizedId}/read`);\n  return response.data;\n};\n\n/**\n * Ottiene lo stato della chat (typing e lettura)\n * @param {string} chatId - L'ID della chat\n * @returns {Promise<Object>} La risposta dall'API\n */\nconst getChatStatus = async (chatId) => {\n  const normalizedId = normalizeChatId(chatId);\n  const response = await apiClient.get(`/chats/${normalizedId}/status`);\n  return response.data;\n};\n\nconst chatService = {\n  getChatById,\n  leaveChat,\n  startTyping,\n  stopTyping,\n  markAsRead,\n  getChatStatus\n};\n// Esporta anche closeChat per gli host\nchatService.closeChat = closeChat;\n\nexport default chatService;","// extracted by mini-css-extract-plugin\nexport default {\"chatPage\":\"ChatPage_chatPage__yEme2\",\"chatHeader\":\"ChatPage_chatHeader__z75hE\",\"backButton\":\"ChatPage_backButton__u79To\",\"chatTitle\":\"ChatPage_chatTitle__X7I1i\",\"headerMeta\":\"ChatPage_headerMeta__VUtjS\",\"headerAvatar\":\"ChatPage_headerAvatar__GkaOq\",\"participantsSummary\":\"ChatPage_participantsSummary__jZ5ad\",\"menuButton\":\"ChatPage_menuButton__37GQ5\",\"messagesContainer\":\"ChatPage_messagesContainer__ZVs0q\",\"messagesList\":\"ChatPage_messagesList__e63Dk\",\"message\":\"ChatPage_message__VItal\",\"messageItem\":\"ChatPage_messageItem__2Lw6p\",\"messageAvatar\":\"ChatPage_messageAvatar__eiOJ8\",\"avatar\":\"ChatPage_avatar__VuHYA\",\"messageContent\":\"ChatPage_messageContent__2-Nz1\",\"messageBubble\":\"ChatPage_messageBubble__8ngs9\",\"messageAuthor\":\"ChatPage_messageAuthor__asCuF\",\"senderName\":\"ChatPage_senderName__2J-3-\",\"messageText\":\"ChatPage_messageText__HObwL\",\"messageTime\":\"ChatPage_messageTime__+Gn4l\",\"timestamp\":\"ChatPage_timestamp__XZPXp\",\"otherMessage\":\"ChatPage_otherMessage__scy10\",\"ownMessage\":\"ChatPage_ownMessage__iNbPL\",\"myMessage\":\"ChatPage_myMessage__1wYMv\",\"optimistic\":\"ChatPage_optimistic__2ucmi\",\"messageForm\":\"ChatPage_messageForm__O6ZGF\",\"messageInput\":\"ChatPage_messageInput__A44ju\",\"chatInput\":\"ChatPage_chatInput__1igyU\",\"sendButton\":\"ChatPage_sendButton__uosVs\",\"dropdownMenu\":\"ChatPage_dropdownMenu__IraF2\",\"dropdownItem\":\"ChatPage_dropdownItem__L6MMH\",\"dangerItem\":\"ChatPage_dangerItem__Vm0MV\",\"typingIndicator\":\"ChatPage_typingIndicator__SlU-k\"};","import React, { useState } from 'react';\nimport { Modal, Button, Form } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\n\nconst LeaveReportModal = ({ show, onClose, onConfirm, type }) => {\n  const { t } = useTranslation();\n  const [reason, setReason] = useState('');\n  const [customReason, setCustomReason] = useState('');\n\n  const handleConfirm = () => {\n    onConfirm({ reason, customReason: reason === 'other' ? customReason : undefined });\n    setReason('');\n    setCustomReason('');\n  };\n\n  const subjectKey = `leaveReport.subjects.${type || 'chat'}`;\n\n  return (\n    <Modal show={show} onHide={onClose} centered backdrop=\"static\" keyboard={false}>\n      <Modal.Header closeButton>\n        <Modal.Title>{t('leaveReport.leaveTitle', { subject: t(subjectKey) })}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body style={{ maxHeight: '60vh', overflowY: 'auto', paddingBottom: 'env(safe-area-inset-bottom, 16px)' }}>\n        <Form>\n          <Form.Group>\n            <Form.Label>{t('leaveReport.whyLeaving', { subject: t(subjectKey) })}</Form.Label>\n            <Form.Control as=\"select\" value={reason} onChange={e => setReason(e.target.value)}>\n              <option value=\"\">{t('leaveReport.selectReason')}</option>\n              <option value=\"personal\">{t('leaveReport.reasons.personal')}</option>\n              <option value=\"uncomfortable\">{t('leaveReport.reasons.uncomfortable')}</option>\n              <option value=\"technical\">{t('leaveReport.reasons.technical')}</option>\n              <option value=\"other\">{t('leaveReport.reasons.other')}</option>\n            </Form.Control>\n          </Form.Group>\n          {reason === 'other' && (\n            <Form.Group className=\"mt-2\">\n              <Form.Control\n                type=\"text\"\n                placeholder={t('leaveReport.writeReason')}\n                value={customReason}\n                onChange={e => setCustomReason(e.target.value)}\n              />\n            </Form.Group>\n          )}\n        </Form>\n      </Modal.Body>\n      <Modal.Footer style={{ position: 'sticky', bottom: 0, background: '#fff', paddingBottom: 'calc(env(safe-area-inset-bottom, 0px) + 12px)' }}>\n        <Button variant=\"secondary\" onClick={onClose}>{t('leaveReport.cancel')}</Button>\n        <Button variant=\"danger\" onClick={handleConfirm} disabled={!reason || (reason === 'other' && !customReason)}>{t('leaveReport.confirm')}</Button>\n      </Modal.Footer>\n    </Modal>\n  );\n};\n\nexport default LeaveReportModal; ","// File: src/pages/ChatPage/index.js (Versione Finale e Moderna)\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Spinner, Alert, Button } from 'react-bootstrap';\nimport { useTranslation } from 'react-i18next';\nimport { io } from 'socket.io-client';\nimport { useAuth } from '../../contexts/AuthContext';\nimport chatService from '../../services/chatService';\nimport { getHostAvatarUrl } from '../../constants/mealConstants';\nimport styles from './ChatPage.module.css';\nimport { toast } from 'react-toastify';\nimport { IoSend } from 'react-icons/io5';\nimport BackButton from '../../components/common/BackButton';\nimport LeaveReportModal from '../../components/meals/LeaveReportModal';\nimport { sendLeaveReport } from '../../services/apiService';\nimport mealService from '../../services/mealService';\nimport { Keyboard } from '@capacitor/keyboard';\nimport { Capacitor } from '@capacitor/core';\nimport { API_URL } from '../../config/capacitorConfig';\n\nconst ChatPage = () => {\n  const { t } = useTranslation();\n  const params = useParams();\n  \n  // Normalizza chatId: estrai la stringa dall'oggetto params con logica piÃ¹ robusta\n  let chatIdRaw = params.chatId;\n  \n  // Se Ã¨ giÃ  una stringa valida, usala direttamente\n  if (typeof chatIdRaw === 'string' && chatIdRaw.trim() !== '' && chatIdRaw !== 'undefined' && chatIdRaw !== 'null' && !chatIdRaw.includes('[object Object]')) {\n    // Ãˆ una stringa valida\n  } else if (typeof chatIdRaw === 'object' && chatIdRaw !== null) {\n    // Se Ã¨ un oggetto, prova a estrarre l'ID\n    chatIdRaw = chatIdRaw._id || chatIdRaw.id || chatIdRaw.chatId || chatIdRaw.toString();\n    console.warn('âš ï¸ [ChatPage] params.chatId era un oggetto, estratto:', chatIdRaw);\n  }\n  \n  // Converti sempre in stringa e rimuovi valori invalidi\n  const chatId = String(chatIdRaw || '').trim();\n  \n  // Validazione finale: controlla se Ã¨ valido\n  const isValidChatId = chatId && \n                        chatId !== 'undefined' && \n                        chatId !== 'null' && \n                        !chatId.includes('[object Object]') &&\n                        chatId.length > 0;\n  \n  const { user, token } = useAuth();\n  const navigate = useNavigate();\n\n  // Log per debug\n  console.log('[ChatPage] params completo:', params);\n  console.log('[ChatPage] chatIdRaw originale:', chatIdRaw);\n  console.log('[ChatPage] chatId normalizzato:', chatId);\n  console.log('[ChatPage] chatId valido?', isValidChatId);\n\n  const [chat, setChat] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [connectionStatus, setConnectionStatus] = useState('connecting');\n  const socketRef = useRef(null);\n  const messagesEndRef = useRef(null);\n  const messageIdsRef = useRef(new Set());\n\n  console.log(`[DEBUG] Render - Stato Connessione: ${connectionStatus}`);\n\n\n  const [typingUsers, setTypingUsers] = useState([]);\n  const typingTimeoutRef = useRef(null);\n\n  const currentUserId = user?._id || user?.id;\n  const currentUserName = user?.nickname || user?.name || 'Tu';\n\n  const [hostAvatar, setHostAvatar] = useState(null);\n  const [participantsCount, setParticipantsCount] = useState(null);\n  const [maxParticipants, setMaxParticipants] = useState(null);\n\n  const normalizeMessage = (msg) => {\n    const sender = msg.sender || msg.user || {};\n    const senderId = sender._id || msg.userId;\n    return {\n      _id: msg._id || msg.id,\n      sender,\n      senderId,\n      username: sender.nickname || msg.username || '',\n      profileImage: sender.profileImage,\n      content: msg.content,\n      timestamp: msg.timestamp || msg.createdAt || new Date().toISOString(),\n    };\n  };\n  const [showLeaveModal, setShowLeaveModal] = useState(false);\n\n  // Effetto per lo scroll automatico \n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  // Gestione tastiera mobile: usa 'native' per ridimensionamento automatico della WebView\n  useEffect(() => {\n    let showSub;\n    \n    const setupKeyboard = async () => {\n      try {\n        if (Capacitor.isNativePlatform()) {\n          // 'native' ridimensiona l'intera WebView visibile quando appare la tastiera\n          await Keyboard.setResizeMode({ mode: 'native' });\n          \n          // Quando la tastiera si apre, scrolla in fondo per vedere l'ultimo messaggio\n          showSub = Keyboard.addListener('keyboardDidShow', () => {\n            // Aspetta che la WebView si sia ridimensionata, poi scrolla\n            setTimeout(() => {\n              messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n            }, 100);\n          });\n        }\n      } catch (error) {\n        console.warn('[ChatPage] Errore nella configurazione della tastiera:', error);\n      }\n    };\n    \n    setupKeyboard();\n    \n    return () => {\n      showSub?.remove?.();\n    };\n  }, []);\n\n  // Effetto principale per dati e socket \n  useEffect(() => {\n    let mounted = true;\n\n    const fetchChatHistory = async () => {\n      // Validazione chatId: deve essere una stringa valida\n      if (!isValidChatId) {\n        console.error('[ChatPage] ERRORE: chatId non valido dopo normalizzazione:', {\n          chatIdRaw: params.chatId,\n          chatIdNormalized: chatId,\n          isValidChatId\n        });\n        setError(t('chat.loadError'));\n        setLoading(false);\n        return;\n      }\n\n      try {\n        setLoading(true);\n        console.log('[ChatPage] Chiamata API con chatId:', chatId, 'Tipo:', typeof chatId);\n        const chatData = await chatService.getChatById(chatId.trim());\n        console.log('[ChatPage] Dati chat ricevuti dal servizio:', {\n          hasChat: !!chatData,\n          hasMessages: !!chatData?.messages,\n          messagesCount: chatData?.messages?.length || 0,\n          chatKeys: chatData ? Object.keys(chatData) : []\n        });\n        if (mounted) {\n          setChat(chatData);\n          const initial = (chatData.messages || []).map(normalizeMessage);\n          console.log('[ChatPage] Messaggi normalizzati:', initial.length);\n          setMessages(initial);\n          // Registra gli ID per deduplicare\n          messageIdsRef.current = new Set(initial.map(m => m._id).filter(Boolean));\n\n          // Prova a ricavare meta dalla chat; altrimenti fallback al meal\n          const countFromChat = Array.isArray(chatData.participants) ? chatData.participants.length : null;\n          const maxFromChat = typeof chatData.maxParticipants === 'number' ? chatData.maxParticipants : null;\n          if (countFromChat != null) setParticipantsCount(countFromChat);\n          if (maxFromChat != null) setMaxParticipants(maxFromChat);\n\n          if (chatData.mealId) {\n            try {\n              const meal = await mealService.getMealById(chatData.mealId);\n              // Se il servizio restituisce { data: meal }, uniformiamo\n              const mealObj = meal?.data || meal;\n              if (mealObj) {\n                setParticipantsCount(mealObj.participants?.length ?? participantsCount);\n                setMaxParticipants(mealObj.maxParticipants ?? maxParticipants);\n                const profileImage = mealObj.host?.profileImage;\n                if (profileImage) setHostAvatar(getHostAvatarUrl(profileImage));\n              }\n            } catch (_) {}\n          }\n        }\n      } catch (err) {\n        if (mounted) {\n            setError(t('chat.loadError'));\n            toast.error(err.response?.data?.error || t('chat.loadError'));\n        }\n      } finally {\n        if (mounted) setLoading(false);\n      }\n    };\n\n    fetchChatHistory();\n\n    console.log('[DEBUG] Tentativo di connessione, token presente:', !!token);\n\n  \n    // Se non c'Ã¨ il token, non tentare di connettere il socket\n    if (!token) {\n      setConnectionStatus('error');\n      setError(t('chat.authRequired'));\n      console.error('[DEBUG] ERRORE: Token non trovato. Impossibile connettere il socket.');\n\n      return;\n  }\n\n\n    // Usa esattamente lo stesso indirizzo IP delle API HTTP\n    const apiUrl = (process.env.REACT_APP_API_URL || API_URL || '').replace(/\\/$/, '');\n    const socketUrl = apiUrl.replace(/\\/api\\/?$/, '');\n    console.log(`[DEBUG] API URL: ${apiUrl}`);\n    console.log(`[DEBUG] Socket URL: ${socketUrl}`);\n    \n    const socket = io(socketUrl, { \n      auth: { token },\n      // Permetti fallback a polling per reti che bloccano i WebSocket\n      transports: ['websocket', 'polling'],\n      reconnection: true,\n      reconnectionAttempts: Infinity,\n      reconnectionDelay: 2000,\n      timeout: 15000,\n      withCredentials: true\n    });\n        \n    socketRef.current = socket;\n\n    socket.on('connect', () => {\n      console.log('[DEBUG] Socket connesso!');\n      setConnectionStatus('connected');\n      // Unisciti alla stanza dopo la connessione - passa solo la stringa chatId\n      if (chatId && typeof chatId === 'string' && chatId.trim() !== '') {\n        console.log('[ChatPage] joinChatRoom con chatId:', chatId.trim());\n        socket.emit('joinChatRoom', chatId.trim());\n      } else {\n        console.error('[ChatPage] ERRORE: chatId non valido per joinChatRoom:', chatId);\n      }\n    });\n\n    socket.on('disconnect', () => {\n      console.log('[DEBUG] Socket disconnesso!');\n      setConnectionStatus('disconnected');\n    });\n\n    socket.on('connect_error', (error) => {\n      console.error('[DEBUG] Errore di connessione socket:', error);\n      setConnectionStatus('error');\n      setError(t('chat.connectionError'));\n    });\n\n    socket.on('reconnect', (attempt) => {\n      console.log('[DEBUG] Socket riconnesso, tentativo:', attempt);\n      setConnectionStatus('connected');\n      // Riunisciti alla stanza dopo la riconnessione - passa solo la stringa chatId\n      if (chatId && typeof chatId === 'string' && chatId.trim() !== '') {\n        console.log('[ChatPage] joinChatRoom (reconnect) con chatId:', chatId.trim());\n        socket.emit('joinChatRoom', chatId.trim());\n      } else {\n        console.error('[ChatPage] ERRORE: chatId non valido per joinChatRoom (reconnect):', chatId);\n      }\n    });\n\n    socket.on('receiveMessage', (message) => {\n      console.log('[DEBUG] Nuovo messaggio ricevuto:', message);\n      const nm = normalizeMessage(message);\n      const mid = nm._id;\n      if (mid && messageIdsRef.current.has(mid)) return;\n      if (mid) messageIdsRef.current.add(mid);\n      setMessages(prev => [...prev, nm]);\n    });\n\n    socket.on('userTyping', ({ user: typingUser, isTyping }) => {\n      if (!typingUser?._id) return;\n      setTypingUsers(prev => {\n        const exists = prev.find(u => u.userId === typingUser._id);\n        if (isTyping) {\n          if (exists) return prev;\n          return [...prev, { userId: typingUser._id, username: typingUser.nickname }];\n        }\n        return prev.filter(u => u.userId !== typingUser._id);\n      });\n    });\n\n    // Join gestito sui callback di connect/reconnect\n\n    return () => {\n      mounted = false;\n      if (socketRef.current) {\n        socketRef.current.disconnect();\n      }\n    };\n  }, [chatId, token, t]);\n\n  const handleTyping = () => {\n    // Validazione chatId prima di inviare typing\n    if (!chatId || typeof chatId !== 'string' || chatId.trim() === '') {\n      return;\n    }\n    \n    const validChatId = chatId.trim();\n    if (socketRef.current && socketRef.current.connected) {\n      socketRef.current.emit('typing', { chatId: validChatId, isTyping: true });\n      if (typingTimeoutRef.current) clearTimeout(typingTimeoutRef.current);\n      typingTimeoutRef.current = setTimeout(() => {\n        if (socketRef.current?.connected) {\n          socketRef.current.emit('typing', { chatId: validChatId, isTyping: false });\n        }\n      }, 1000);\n    }\n  };\n\n  const handleSendMessage = (e) => {\n    e.preventDefault();\n    if (!newMessage.trim() || !socketRef.current?.connected) return;\n    \n    // Validazione chatId prima di inviare\n    if (!chatId || typeof chatId !== 'string' || chatId.trim() === '') {\n      console.error('[ChatPage] ERRORE: chatId non valido in handleSendMessage:', chatId);\n      return;\n    }\n\n    const validChatId = chatId.trim();\n    const messageData = {\n      chatId: validChatId,\n      content: newMessage.trim(),\n      timestamp: new Date().toISOString()\n    };\n\n    socketRef.current.emit('sendMessage', { chatId: validChatId, content: messageData.content }, (ack) => {\n      // Non aggiungiamo subito il messaggio: arriverÃ  tramite 'receiveMessage'.\n      // Evitiamo duplicati lato mittente.\n    });\n    setNewMessage('');\n    \n    // Stop typing indicator\n    if (socketRef.current?.connected && validChatId) {\n      socketRef.current.emit('typing', { chatId: validChatId, isTyping: false });\n    }\n  };\n\n  const handleLeaveChatWithReason = async ({ reason, customReason }) => {\n    try {\n      if (isHost) {\n        toast.info(t('chat.hostCannotLeave'));\n        setShowLeaveModal(false);\n        return;\n      }\n      await sendLeaveReport({ type: 'chat', id: chatId, reason, customReason });\n      await chatService.leaveChat(chatId);\n      toast.success(t('chat.leaveSuccess'));\n      navigate('/meals');\n    } catch (err) {\n      // Silenzia errori di rete transitori\n      const transient = err?.code === 'ERR_NETWORK' || err?.code === 'ECONNABORTED' || !err?.response;\n      if (!transient) toast.error(t('chat.leaveError'));\n      navigate('/meals');\n    } finally {\n      setShowLeaveModal(false);\n    }\n  };\n\n  const hostId = chat?.mealId?.host?._id || chat?.mealId?.host || chat?.host?._id || chat?.host;\n  const isHost = !!(chat && hostId && hostId.toString() === (currentUserId || '').toString());\n  const handleCloseChat = async () => {\n    try {\n      await chatService.closeChat(chatId);\n      toast.success(t('chat.closeSuccess'));\n      navigate('/meals');\n    } catch (err) {\n      const transient = err?.code === 'ERR_NETWORK' || err?.code === 'ECONNABORTED' || !err?.response;\n      if (!transient) toast.error(t('chat.closeError'));\n      navigate('/meals');\n    }\n  };\n\n  // Funzione per riprovare a caricare la chat\n  const loadChat = async () => {\n    setError('');\n    setLoading(true);\n    if (!isValidChatId) {\n      setError(t('chat.loadError'));\n      setLoading(false);\n      return;\n    }\n    try {\n      const chatData = await chatService.getChatById(chatId.trim());\n      setChat(chatData);\n      const initial = (chatData.messages || []).map(normalizeMessage);\n      setMessages(initial);\n      messageIdsRef.current = new Set(initial.map(m => m._id).filter(Boolean));\n      \n      const countFromChat = Array.isArray(chatData.participants) ? chatData.participants.length : null;\n      const maxFromChat = typeof chatData.maxParticipants === 'number' ? chatData.maxParticipants : null;\n      if (countFromChat != null) setParticipantsCount(countFromChat);\n      if (maxFromChat != null) setMaxParticipants(maxFromChat);\n\n      if (chatData.mealId) {\n        try {\n          const meal = await mealService.getMealById(chatData.mealId);\n          const mealObj = meal?.data || meal;\n          if (mealObj) {\n            setParticipantsCount(mealObj.participants?.length ?? participantsCount);\n            setMaxParticipants(mealObj.maxParticipants ?? maxParticipants);\n            const profileImage = mealObj.host?.profileImage;\n            if (profileImage) setHostAvatar(getHostAvatarUrl(profileImage));\n          }\n        } catch (_) {}\n      }\n      setError('');\n    } catch (err) {\n      setError(t('chat.loadError'));\n      toast.error(err.response?.data?.error || t('chat.loadError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // --- NUOVA LOGICA DI RENDERING CON PRIORITÃ€ AI DATI ---\n  // Mostra lo spinner solo se sta caricando E non abbiamo ancora dati da mostrare\n  // --- INSERISCI QUESTI LOG DI DEBUG QUI ---\n  console.log(`[ChatPage Rendering Check] loading=${loading}, error=${JSON.stringify(error)}, chatExists=${!!chat}`);\n  // -----------------------------------------\n  if (loading && !chat) {\n    console.log('[ChatPage Rendering Decision] Mostro Spinner (loading e no chat)');\n    return (\n      <div className=\"d-flex flex-column justify-content-center align-items-center\" style={{ minHeight: '50vh' }}>\n        <Spinner animation=\"border\" />\n        <p className=\"mt-3\">{t('chat.loading') || 'Caricamento...'}</p>\n      </div>\n    );\n  }\n\n  // Se c'Ã¨ un errore E NON abbiamo dati validi da mostrare, allora mostra l'errore\n  if (error && !chat) {\n    console.log(`[ChatPage Rendering Decision] Mostro Errore Bloccante (error=${JSON.stringify(error)} e no chat)`);\n    return (\n      <div className=\"text-center py-5\">\n        <Alert variant=\"danger\">\n          <Alert.Heading>{t('chat.errorTitle')}</Alert.Heading>\n          <p>{error}</p>\n          <Button onClick={loadChat} variant=\"primary\" className=\"mt-2\">{t('chat.retry') || 'Riprova'}</Button>\n          <div className=\"mt-2\">\n            <BackButton />\n          </div>\n        </Alert>\n      </div>\n    );\n  }\n  \n  // Controllo finale: se non abbiamo chat e non stiamo caricando, mostra un warning\n  if (!chat && !loading) {\n    console.log('[ChatPage Rendering Decision] Mostro No Data Alert (chat is null/undefined)');\n    return (\n      <div className=\"text-center py-5\">\n        <Alert variant=\"warning\">\n          <Alert.Heading>{t('chat.notFoundTitle')}</Alert.Heading>\n          <p>{t('chat.notFoundMessage')}</p>\n          <Button onClick={loadChat} variant=\"primary\" className=\"mt-2\">{t('chat.retry') || 'Riprova'}</Button>\n          <div className=\"mt-2\">\n            <BackButton />\n          </div>\n        </Alert>\n      </div>\n    );\n  }\n\n  console.log('[ChatPage Rendering Decision] Mostro Interfaccia Chat Principale');\n  return (\n    <div className={styles.chatPage}>\n      {/* Mostra un piccolo avviso se c'Ã¨ stato un errore ma stiamo mostrando dati esistenti */}\n      {error && chat && (\n        <>\n          {console.log(`[ChatPage Rendering Decision] Mostro Warning Non Bloccante (error=${JSON.stringify(error)} ma chat esiste)`)}\n        <Alert variant=\"warning\" dismissible onClose={() => setError('')} className=\"m-2\">\n          <Alert.Heading>{t('chat.loadErrorButShowingOld') || 'Errore di caricamento'}</Alert.Heading>\n          <p>{error}</p>\n          <Button size=\"sm\" onClick={loadChat} variant=\"outline-primary\">{t('chat.retry') || 'Riprova'}</Button>\n        </Alert>\n        </>\n      )}\n      \n      <div className={styles.chatHeader}>\n        <BackButton className={styles.backButton} />\n        <div className={styles.chatInfo}>\n          <p className={styles.chatTitle}>{chat?.name || chat?.title || t('chat.subtitle')}</p>\n          <div className={styles.headerMeta}>\n            {hostAvatar && (\n              <img src={hostAvatar} alt={t('profile.header.avatarAlt')} className={styles.headerAvatar} />\n            )}\n            {participantsCount != null && maxParticipants != null && (\n              <span className={styles.participantsSummary}>\n                {t('meals.detail.participantsText', { current: participantsCount, max: maxParticipants })}\n              </span>\n            )}\n          </div>\n        </div>\n        <div className=\"d-flex align-items-center\" style={{ gap: 8 }}>\n          {chat && isHost ? (\n            <Button size=\"sm\" variant=\"outline-danger\" onClick={handleCloseChat}>{t('chat.close')}</Button>\n          ) : chat ? (\n            <Button size=\"sm\" variant=\"outline-secondary\" onClick={() => setShowLeaveModal(true)}>{t('chat.leave')}</Button>\n          ) : null}\n        </div>\n      </div>\n\n      <div className={styles.messagesContainer}>\n        {messages && messages.length > 0 ? (\n          messages.map((message, index) => (\n          <div \n            key={message?._id || index} \n            className={`${styles.message} ${message?.senderId === currentUserId ? styles.ownMessage : styles.otherMessage}`}\n          >\n            <div className={styles.messageContent}>\n              <div className={styles.messageHeader}>\n                <img \n                  src={getHostAvatarUrl(message?.user || message?.sender)} \n                  alt={t('chat.userAvatarAlt')}\n                  className={styles.messageAvatar}\n                />\n                <span className={styles.messageAuthor}>{message?.username || message?.sender?.nickname || t('chat.unknownUser')}</span>\n                <span className={styles.messageTime}>\n                  {message?.timestamp ? new Date(message.timestamp).toLocaleTimeString() : ''}\n                </span>\n              </div>\n              <div className={styles.messageText}>{message?.content || ''}</div>\n            </div>\n          </div>\n          ))\n        ) : (\n          <div className=\"text-center py-4 text-muted\">{t('chat.noMessagesYet') || 'Nessun messaggio ancora'}</div>\n        )}\n        \n        {typingUsers.length > 0 && (\n          <div className={styles.typingIndicator}>\n            {typingUsers.map(user => user?.username || t('chat.unknownUser')).join(', ')} {t('chat.isTyping')}\n          </div>\n        )}\n        \n        <div ref={messagesEndRef} />\n      </div>\n\n      <form onSubmit={handleSendMessage} className={styles.messageForm} style={{ pointerEvents: showLeaveModal ? 'none' : 'auto', opacity: showLeaveModal ? 0.4 : 1 }}>\n        <input\n          type=\"text\"\n          value={newMessage}\n          onChange={(e) => {\n            setNewMessage(e.target.value);\n            handleTyping();\n          }}\n          placeholder={t('chat.messagePlaceholder')}\n          className={styles.messageInput}\n          disabled={connectionStatus !== 'connected'}\n          enterKeyHint=\"send\"\n          onKeyDown={(e) => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              handleSendMessage(e);\n            }\n          }}\n        />\n        <button \n          type=\"submit\" \n          className={styles.sendButton}\n          disabled={!newMessage.trim() || connectionStatus !== 'connected'}\n        >\n          <IoSend />\n        </button>\n      </form>\n\n      <LeaveReportModal\n        show={showLeaveModal}\n        onClose={() => setShowLeaveModal(false)}\n        onConfirm={handleLeaveChatWithReason}\n        type=\"chat\"\n      />\n    </div>\n  );\n};\n\nexport default ChatPage;"],"names":["_ref","className","navigate","useNavigate","_jsxs","onClick","handleBack","concat","styles","children","_jsx","FaArrowLeft","style","marginRight","normalizeChatId","chatId","_id","id","String","trim","chatService","getChatById","async","_normalizedChatId","_normalizedChatId2","_response$data","_response$data2","_response$data3","_response$data4","_response$data5","_response$data6","_response$data7","normalizedChatId","console","warn","error","Error","message","log","length","match","response","apiClient","get","data","hasData","hasChat","chat","hasMessages","messages","hasSuccess","success","keys","Object","chatData","_objectSpread","_error$response","_error$response2","_error$config","_error$response3","status","statusText","url","config","responseData","leaveChat","normalizedId","delete","suppressErrorAlert","startTyping","post","stopTyping","markAsRead","getChatStatus","put","show","onClose","onConfirm","type","t","useTranslation","reason","setReason","useState","customReason","setCustomReason","subjectKey","Modal","onHide","centered","backdrop","keyboard","Header","closeButton","Title","subject","Body","maxHeight","overflowY","paddingBottom","Form","Group","Label","Control","as","value","onChange","e","target","placeholder","Footer","position","bottom","background","Button","variant","handleConfirm","undefined","disabled","ChatPage","_chat$mealId","_chat$mealId$host","_chat$mealId2","_chat$host","params","useParams","chatIdRaw","includes","toString","isValidChatId","user","token","useAuth","setChat","setMessages","newMessage","setNewMessage","loading","setLoading","setError","connectionStatus","setConnectionStatus","socketRef","useRef","messagesEndRef","messageIdsRef","Set","typingUsers","setTypingUsers","typingTimeoutRef","currentUserId","hostAvatar","setHostAvatar","nickname","name","participantsCount","setParticipantsCount","maxParticipants","setMaxParticipants","normalizeMessage","msg","sender","senderId","userId","username","profileImage","content","timestamp","createdAt","Date","toISOString","showLeaveModal","setShowLeaveModal","useEffect","_messagesEndRef$curre","current","scrollIntoView","behavior","showSub","Capacitor","isNativePlatform","Keyboard","setResizeMode","mode","addListener","setTimeout","_messagesEndRef$curre2","setupKeyboard","_showSub","_showSub$remove","remove","call","mounted","chatIdNormalized","_chatData$messages","messagesCount","chatKeys","initial","map","m","filter","Boolean","countFromChat","Array","isArray","participants","maxFromChat","mealId","meal","mealService","getMealById","mealObj","_mealObj$participants","_mealObj$participants2","_mealObj$maxParticipa","_mealObj$host","host","getHostAvatarUrl","_","err","_err$response","_err$response$data","toast","fetchChatHistory","apiUrl","process","replace","socketUrl","socket","io","auth","transports","reconnection","reconnectionAttempts","Infinity","reconnectionDelay","timeout","withCredentials","on","emit","attempt","nm","mid","has","add","prev","typingUser","isTyping","exists","find","u","disconnect","handleSendMessage","_socketRef$current2","_socketRef$current3","preventDefault","connected","validChatId","messageData","ack","hostId","isHost","loadChat","_mealObj$participants3","_mealObj$participants4","_mealObj$maxParticipa2","_mealObj$host2","_err$response2","_err$response2$data","JSON","stringify","minHeight","Spinner","animation","Alert","Heading","BackButton","chatPage","_Fragment","dismissible","size","chatHeader","backButton","chatInfo","chatTitle","title","headerMeta","src","alt","headerAvatar","participantsSummary","max","gap","closeChat","code","messagesContainer","index","_message$sender","ownMessage","otherMessage","messageContent","messageHeader","messageAvatar","messageAuthor","messageTime","toLocaleTimeString","messageText","typingIndicator","join","ref","onSubmit","messageForm","pointerEvents","opacity","handleTyping","clearTimeout","_socketRef$current","messageInput","enterKeyHint","onKeyDown","key","shiftKey","sendButton","IoSend","LeaveReportModal","_ref2","info","sendLeaveReport"],"ignoreList":[],"sourceRoot":""}