/*! For license information please see 250.f7c5df9a.chunk.js.LICENSE.txt */
(self.webpackChunktable_talk_client=self.webpackChunktable_talk_client||[]).push([[250],{549:(e,a,t)=>{"use strict";t.d(a,{A:()=>x});var s=t(5043),n=t(9896),r=t(9419),i=t(6036),l=t(3318),o=t(2023),c=t(228),d=t.n(c),p=(t(6433),t(579));function m(e){let{position:a}=e;const t=(0,n.ko)();return(0,s.useEffect)(()=>{a&&t.setView([a.lat,a.lng],t.getZoom())},[a,t]),null}function u(e){let{onLocationSelect:a,onMapClick:t}=e;return(0,n.Po)({click(e){const{lat:s,lng:n}=e.latlng;t&&t(),a&&a({lat:s,lng:n})}}),null}delete d().Icon.Default.prototype._getIconUrl,d().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const x=e=>{let{meals:a=[],markers:t=[],onLocationSelect:n,onMarkerClick:c,onMapClick:x,selectedLocation:h,userLocation:g=null,zoom:_=13,height:j="400px",width:v="100%",center:b=[45.4642,9.19]}=e;const[f,y]=(0,s.useState)(""),[C,M]=(0,s.useState)([]),[N,k]=(0,s.useState)(!1),w=async e=>{if(e&&!(e.length<3)){k(!0);try{const a=await fetch("https://nominatim.openstreetmap.org/search?format=json&q=".concat(encodeURIComponent(e),"&limit=5&countrycodes=it&addressdetails=1")),t=(await a.json()).map(e=>({id:e.place_id,name:e.display_name,lat:parseFloat(e.lat),lng:parseFloat(e.lon),address:e.display_name}));M(t)}catch(a){console.error("Errore ricerca luoghi:",a),M([])}finally{k(!1)}}};return(0,p.jsxs)("div",{style:{width:"100%"},children:[(0,p.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)("input",{type:"text",placeholder:"\ud83d\udd0d Cerca ristoranti, indirizzi...",value:f,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&w(f),style:{width:"100%",padding:"12px",border:"2px solid #ddd",borderRadius:"8px",fontSize:"16px"}}),(0,p.jsx)("button",{onClick:()=>w(f),disabled:N,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"#FF6B35",color:"white",border:"none",padding:"8px 12px",borderRadius:"6px",cursor:"pointer"},children:N?"...":"Cerca"})]}),C.length>0&&(0,p.jsx)("div",{style:{position:"absolute",zIndex:1e3,background:"white",border:"1px solid #ddd",borderRadius:"8px",marginTop:"5px",maxHeight:"200px",overflowY:"auto",width:"100%"},children:C.map(e=>(0,p.jsxs)("div",{onClick:()=>{n&&n({lat:e.lat,lng:e.lng,address:e.address}),M([]),y(e.name.split(",")[0])},style:{padding:"10px",cursor:"pointer",borderBottom:"1px solid #eee",fontSize:"14px"},onMouseEnter:e=>e.target.style.backgroundColor="#f5f5f5",onMouseLeave:e=>e.target.style.backgroundColor="white",children:["\ud83d\udccd ",e.name]},e.id))})]}),(0,p.jsxs)(r.W,{center:b,zoom:_,style:{height:j,width:v,borderRadius:"8px"},children:[(0,p.jsx)(o.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,p.jsx)(u,{onLocationSelect:n,onMapClick:x}),h&&(0,p.jsx)(m,{position:h}),g&&(0,p.jsx)(i.p,{position:[g.lat,g.lng],icon:d().icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),children:(0,p.jsxs)(l.z,{children:["\ud83d\udccd ",(0,p.jsx)("strong",{children:"La tua posizione"})]})}),h&&(0,p.jsx)(i.p,{position:[h.lat,h.lng],children:(0,p.jsxs)(l.z,{children:["\ud83d\udccd ",(0,p.jsx)("strong",{children:"Posizione selezionata"}),(0,p.jsx)("br",{}),h.address||"".concat(h.lat.toFixed(4),", ").concat(h.lng.toFixed(4))]})}),t.map(e=>(0,p.jsx)(i.p,{position:[e.lat,e.lng],eventHandlers:{click:()=>{c&&c(e.id)}},children:(0,p.jsx)(l.z,{children:(0,p.jsxs)("div",{style:{minWidth:"200px"},children:[(0,p.jsxs)("h3",{style:{margin:"0 0 8px 0",color:"#FF6B35"},children:["\ud83c\udf7d\ufe0f ",e.title||e.name]}),e.price&&(0,p.jsxs)("p",{style:{margin:"4px 0"},children:["\ud83d\udcb0 \u20ac",e.price]}),e.type&&(0,p.jsxs)("p",{style:{margin:"4px 0",color:"#666"},children:["\ud83d\udcc5 ",e.type]})]})})},e.id)),a.map(e=>(0,p.jsx)(i.p,{position:[e.lat,e.lng],eventHandlers:{click:()=>{c&&c(e.id)}},children:(0,p.jsx)(l.z,{children:(0,p.jsxs)("div",{style:{minWidth:"200px"},children:[(0,p.jsxs)("h3",{style:{margin:"0 0 8px 0",color:"#FF6B35"},children:["\ud83c\udf7d\ufe0f ",e.name]}),(0,p.jsxs)("p",{style:{margin:"4px 0"},children:["\ud83d\udccd ",e.restaurant||e.address]}),(0,p.jsxs)("p",{style:{margin:"4px 0"},children:["\ud83d\udc65 ",e.participants||0," partecipanti"]}),(0,p.jsxs)("p",{style:{margin:"4px 0"},children:["\ud83d\udcc5 ",e.date]}),(0,p.jsx)("button",{onClick:()=>window.open("/meal/".concat(e.id),"_blank"),style:{background:"#FF6B35",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",cursor:"pointer",marginTop:"8px"},children:"Partecipa al TableTalk"})]})})},e.id))]})]})}},2619:(e,a,t)=>{"use strict";t.d(a,{A:()=>P});t(5043);var s=t(5475),n=t(4117),r=t(184),i=t(5950),l=t(5016),o=t(4935);const c="EditMealButton_editButton__abQ9t";var d=t(579);const p=e=>{let{mealId:a}=e;return(0,d.jsx)(s.N_,{to:"/meals/edit/".concat(a),className:c,children:"Modifica TableTalk\xae"})};var m=t(6229);const u="MealCard_card__ZMpL4",x="MealCard_cardLink__NwoDy",h="MealCard_cardImageWrapper__o3OYh",g="MealCard_cardImageWrapperCompact__NsCVO",_="MealCard_cardImage__NfTS+",j="MealCard_cardImageType__mS24Y",v="MealCard_mealModeBadge__iRhot",b="MealCard_mealModeIcon__1sUXr",f="MealCard_mealModeText__iijFz",y="MealCard_cardTitle__IzHzc",C="MealCard_cardContent__xy66r",M="MealCard_cardDetail__++Z1c",N="MealCard_hostAvatar__SOgSA",k="MealCard_locationIcon__YwiGH",w="MealCard_locationText__4mI9I",A="MealCard_cardDescription__Meeix",T="MealCard_cardActions__apnlz",S="MealCard_actionButtons__m5ryk",I="MealCard_hostLink__HuRU-",P=e=>{var a;let{meal:t,onLeaveSuccess:c,compact:P=!1}=e;const{t:z}=(0,n.Bd)(),{user:B}=(0,l.A)(),{getMealTypeText:R,getMealModeText:F}=(0,o.j)();if(!t||!t.host)return console.error("MealCard ha ricevuto dati incompleti: ",t),null;const L=B&&B.id===t.host._id,D=B&&t.participants&&t.participants.some(e=>e._id===B.id),U=(0,i.xW)(t.imageUrl),H=(0,i.DP)(t.host.profileImage);console.log("\ud83d\udc64 [MealCard] Host ID:",t.host._id||t.host.id),console.log("\ud83d\udc64 [MealCard] Host object:",t.host);const q=t.description&&t.description.length>80?t.description.substring(0,80)+"...":t.description,E=new Date(new Date(t.date).getTime()+6e4*(t.duration||0)),O="completed"===t.status||"cancelled"===t.status||new Date>E;return(0,d.jsxs)("div",{className:u,children:[(0,d.jsxs)(s.N_,{to:"/meals/".concat(t._id),className:x,children:[(0,d.jsxs)("div",{className:P?g:h,children:[(0,d.jsx)("img",{src:U,alt:t.title,className:_}),(0,d.jsx)("div",{className:j,style:{backgroundColor:(0,i.hd)(t.type)},children:R(t.type)}),(0,d.jsxs)("div",{className:v,style:{backgroundColor:(0,i.wI)(t.mealType)},children:[(0,d.jsx)("span",{className:b,children:(0,i.Iy)(t.mealType)}),(0,d.jsx)("span",{className:f,children:F(t.mealType)})]})]}),(0,d.jsxs)("div",{className:C,children:[(0,d.jsx)("h3",{className:y,children:t.title}),(0,d.jsxs)("div",{className:M,children:[(0,d.jsx)(r.gqt,{}),(0,d.jsx)("span",{children:t.language})]}),(0,d.jsx)(s.N_,{to:"/public-profile/".concat(t.host._id||t.host.id),className:I,children:(0,d.jsxs)("div",{className:M,children:[(0,d.jsx)("img",{src:H,alt:t.host.nickname,className:N}),(0,d.jsxs)("span",{children:[z("meals.card.organizedBy")," ",(0,d.jsx)("strong",{children:t.host.nickname})]})]})}),(0,d.jsxs)("div",{className:M,children:[(0,d.jsx)(r.bfZ,{}),(0,d.jsx)("span",{children:(0,i.Yq)(t.date)})]}),!P&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:M,children:[(0,d.jsx)(r.w_X,{}),(0,d.jsxs)("span",{children:[z("meals.card.duration"),": ",t.duration," ",z("meals.card.minutes")]})]}),(0,d.jsxs)("div",{className:M,children:[(0,d.jsx)(r.w_X,{}),(0,d.jsxs)("span",{children:[z("meals.card.end"),": ",(0,i.Yq)(new Date(new Date(t.date).getTime()+6e4*t.duration),"HH:mm")]})]})]}),"physical"===t.mealType&&t.location&&(0,d.jsxs)("div",{className:M,children:[(0,d.jsx)("span",{className:k,children:"\ud83d\udccd"}),(0,d.jsx)("span",{className:w,children:t.location})]}),(0,d.jsx)("p",{className:A,children:q})]})]}),(0,d.jsxs)("div",{className:T,children:[(0,d.jsxs)("div",{className:M,children:[(0,d.jsx)(r.YXz,{}),(0,d.jsxs)("span",{children:[(null===(a=t.participants)||void 0===a?void 0:a.length)||0," / ",t.maxParticipants," ",z("meals.card.participants")]})]}),(0,d.jsxs)("div",{className:S,children:[!P&&L&&!O&&(0,d.jsx)(p,{mealId:t._id}),D&&!L&&!O&&(0,d.jsx)(m.A,{mealId:t._id,onSuccess:c})]})]})]})}},4140:(e,a,t)=>{"use strict";t.d(a,{Am:()=>i,Ay:()=>o});var s=t(5043),n=t(579);const r=["as","disabled"];function i(e){let{tagName:a,disabled:t,href:s,target:n,rel:r,role:i,onClick:l,tabIndex:o=0,type:c}=e;a||(a=null!=s||null!=n||null!=r?"a":"button");const d={tagName:a};if("button"===a)return[{type:c||"button",disabled:t},d];const p=e=>{(t||"a"===a&&function(e){return!e||"#"===e.trim()}(s))&&e.preventDefault(),t?e.stopPropagation():null==l||l(e)};return"a"===a&&(s||(s="#"),t&&(s=void 0)),[{role:null!=i?i:"button",disabled:void 0,tabIndex:t?void 0:o,href:s,target:"a"===a?n:void 0,"aria-disabled":t||void 0,rel:"a"===a?r:void 0,onClick:p,onKeyDown:e=>{" "===e.key&&(e.preventDefault(),p(e))}},d]}const l=s.forwardRef((e,a)=>{let{as:t,disabled:s}=e,l=function(e,a){if(null==e)return{};var t={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(a.indexOf(s)>=0)continue;t[s]=e[s]}return t}(e,r);const[o,{tagName:c}]=i(Object.assign({tagName:t,disabled:s},l));return(0,n.jsx)(c,Object.assign({},l,o,{ref:a}))});l.displayName="Button";const o=l},4250:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>A});var s=t(5043),n=t(4282),r=t(7417),i=t(3216),l=t(4117),o=t(184),c=t(3401),d=t(2179),p=t(549),m=t(2619),u=t(7352);const x="MapPage_mapPage__Q8CXY",h="MapPage_mapContainer__Q57lh",g="MapPage_topBar__pR8QC",_="MapPage_backButton__oXtTT",j="MapPage_searchContainer__y5w4w",v="MapPage_searchIcon__yq5yY",b="MapPage_searchInput__tAxxY",f="MapPage_floatingControls__dH+sb",y="MapPage_fab__ZZ2pb",C="MapPage_mealPreviewContainer__N9PRk",M="MapPage_mealPreviewCard__5nAMT",N="MapPage_closePreview__ZOJrH",k="MapPage_listToggle__f5a4F";var w=t(579);const A=()=>{const{t:e}=(0,l.Bd)(),a=(0,i.Zp)(),[t,A]=(0,s.useState)([41.9028,12.4964]),[T,S]=(0,s.useState)(13),[I,P]=(0,s.useState)([]),[z,B]=(0,s.useState)(!1),[R,F]=(0,s.useState)(null),[L,D]=(0,s.useState)(null),[U,H]=(0,s.useState)(15);(0,s.useEffect)(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{const{latitude:a,longitude:t}=e.coords,s=[a,t];A(s),D(s),q(a,t,U)},e=>{console.warn("Geolocalizzazione non disponibile o negata:",e),c.oR.info("Impossibile rilevare la posizione. Mostro Roma."),q(41.9028,12.4964,U)}):q(41.9028,12.4964,U)},[]);const q=async(a,t,s)=>{try{B(!0);const e=await d.A.getMealsForMap({latitude:a,longitude:t},s,{mealType:"physical",status:"upcoming,ongoing"}),n=e.data||e;console.log("\ud83d\uddfa\ufe0f Trovati ".concat(n.length," pasti sulla mappa")),P(n)}catch(n){console.error("Errore mappa:",n),c.oR.error(e("map.loadError")||"Errore caricamento mappa")}finally{B(!1)}},E=I.filter(e=>e.location&&e.location.coordinates).map(e=>({id:e._id,lat:e.location.coordinates[1],lng:e.location.coordinates[0],title:e.title,price:e.estimatedCost,type:e.type}));return(0,w.jsxs)("div",{className:x,children:[(0,w.jsxs)("div",{className:g,children:[(0,w.jsx)(u.A,{className:_}),(0,w.jsxs)("div",{className:j,children:[(0,w.jsx)(o.KSO,{className:v}),(0,w.jsx)("input",{type:"text",placeholder:e("map.searchPlaceholder")||"Cerca zona...",className:b})]})]}),(0,w.jsx)("div",{className:h,children:(0,w.jsx)(p.A,{center:t,zoom:T,markers:E,onMarkerClick:e=>{const a=I.find(a=>a._id===e);a&&F(a)},onMapClick:()=>{R&&F(null)},userLocation:L?{lat:L[0],lng:L[1]}:null,height:"100%",width:"100%"})}),(0,w.jsxs)("div",{className:f,children:[(0,w.jsx)(n.A,{variant:"light",className:y,onClick:()=>{q(t[0],t[1],U)},children:z?(0,w.jsx)(r.A,{size:"sm"}):"\ud83d\udd04 Cerca qui"}),(0,w.jsx)(n.A,{variant:"light",className:y,onClick:()=>{L?(A(L),S(14)):c.oR.warn("Posizione non disponibile")},children:(0,w.jsx)(o.meu,{color:"#007bff"})})]}),R&&(0,w.jsx)("div",{className:C,children:(0,w.jsxs)("div",{className:M,children:[(0,w.jsx)(m.A,{meal:R,compact:!0,onClick:()=>a("/meals/".concat(R._id))}),(0,w.jsx)("button",{className:N,onClick:()=>F(null),children:"\xd7"})]})}),(0,w.jsxs)(n.A,{className:k,onClick:()=>a("/meals"),children:[(0,w.jsx)(o.svy,{})," ",e("navigation.meals")||"Lista"]})]})}},4282:(e,a,t)=>{"use strict";t.d(a,{A:()=>u});var s=t(2555),n=t(45),r=t(8139),i=t.n(r),l=t(5043),o=t(4140),c=t(7852),d=t(579);const p=["as","bsPrefix","variant","size","active","disabled","className"],m=l.forwardRef((e,a)=>{let{as:t,bsPrefix:r,variant:l="primary",size:m,active:u=!1,disabled:x=!1,className:h}=e,g=(0,n.A)(e,p);const _=(0,c.oU)(r,"btn"),[j,{tagName:v}]=(0,o.Am)((0,s.A)({tagName:t,disabled:x},g)),b=v;return(0,d.jsx)(b,(0,s.A)((0,s.A)((0,s.A)({},j),g),{},{ref:a,disabled:x,className:i()(h,_,u&&"active",l&&"".concat(_,"-").concat(l),m&&"".concat(_,"-").concat(m),g.href&&x&&"disabled")}))});m.displayName="Button";const u=m},4935:(e,a,t)=>{"use strict";t.d(a,{j:()=>r});var s=t(4117),n=t(5950);const r=()=>{const{t:e}=(0,s.Bd)(),a=a=>{const t="meals.mealTypes.".concat(a);return e(t,a)},t=a=>{const t="meals.mealModes.".concat(a);return e(t,a)};return{getMealTypeText:a,getMealModeText:t,getMealStatusText:a=>{const t="meals.mealStatus.".concat(a);return e(t,a)},getMealTypeOptions:()=>[{value:n.q_.BREAKFAST,label:a(n.q_.BREAKFAST)},{value:n.q_.LUNCH,label:a(n.q_.LUNCH)},{value:n.q_.DINNER,label:a(n.q_.DINNER)},{value:n.q_.APERITIF,label:a(n.q_.APERITIF)}],getMealModeOptions:()=>[{value:n.x6.VIRTUAL,label:t(n.x6.VIRTUAL)},{value:n.x6.PHYSICAL,label:t(n.x6.PHYSICAL)}]}}},6229:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});t(5043);var s=t(9926),n=t(4282),r=t(7417),i=t(579);const l=e=>{let{mealId:a,onSuccess:t}=e;const{leaveMeal:l,loading:o}=(0,s.w)();return(0,i.jsx)(n.A,{variant:"outline-danger",className:"w-100",onClick:async()=>{if(window.confirm("Sei sicuro di voler abbandonare questo TableTalk\xae?"))try{const e=await l(a);t&&t(e)}catch(e){console.error("Fallimento leaveMeal nel componente:",e)}},disabled:o,children:o?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.A,{as:"span",animation:"border",size:"sm"}),(0,i.jsx)("span",{children:" Uscita in corso..."})]}):"Abbandona il TableTalk\xae"})}},7352:(e,a,t)=>{"use strict";t.d(a,{A:()=>l});t(5043);var s=t(3216),n=t(184);const r="BackButton_backButton__hBNQM";var i=t(579);const l=e=>{let{className:a=""}=e;const t=(0,s.Zp)();return(0,i.jsxs)("button",{onClick:()=>{t(-1)},className:"".concat(r," ").concat(a),children:[(0,i.jsx)(n.QVr,{style:{marginRight:8}}),"Torna indietro"]})}},7852:(e,a,t)=>{"use strict";t.d(a,{Jm:()=>p,Wz:()=>m,gy:()=>d,oU:()=>c});var s=t(5043);t(579);const n=["xxl","xl","lg","md","sm","xs"],r="xs",i=s.createContext({prefixes:{},breakpoints:n,minBreakpoint:r}),{Consumer:l,Provider:o}=i;function c(e,a){const{prefixes:t}=(0,s.useContext)(i);return e||t[a]||a}function d(){const{breakpoints:e}=(0,s.useContext)(i);return e}function p(){const{minBreakpoint:e}=(0,s.useContext)(i);return e}function m(){const{dir:e}=(0,s.useContext)(i);return"rtl"===e}},8139:(e,a)=>{var t;!function(){"use strict";var s={}.hasOwnProperty;function n(){for(var e="",a=0;a<arguments.length;a++){var t=arguments[a];t&&(e=i(e,r(t)))}return e}function r(e){if("string"===typeof e||"number"===typeof e)return e;if("object"!==typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var a="";for(var t in e)s.call(e,t)&&e[t]&&(a=i(a,t));return a}function i(e,a){return a?e?e+" "+a:e+a:e}e.exports?(n.default=n,e.exports=n):void 0===(t=function(){return n}.apply(a,[]))||(e.exports=t)}()}}]);
//# sourceMappingURL=250.f7c5df9a.chunk.js.map